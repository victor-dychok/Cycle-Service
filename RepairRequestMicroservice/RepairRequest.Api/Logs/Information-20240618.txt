2024-06-18 09:58:07.813 +03:00 [INF] User profile is available. Using 'C:\Users\vitia\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-06-18 09:58:08.062 +03:00 [INF] Now listening on: https://localhost:7014
2024-06-18 09:58:08.062 +03:00 [INF] Now listening on: http://localhost:5281
2024-06-18 09:58:08.063 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2024-06-18 09:58:08.064 +03:00 [INF] Hosting environment: Development
2024-06-18 09:58:08.064 +03:00 [INF] Content root path: D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequestMicroservice\RepairRequest.Api
2024-06-18 09:58:08.614 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/swagger/index.html - null null
2024-06-18 09:58:08.808 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/swagger/index.html - 200 null text/html;charset=utf-8 197.6056ms
2024-06-18 09:58:08.837 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/_framework/aspnetcore-browser-refresh.js - null null
2024-06-18 09:58:08.837 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/_vs/browserLink - null null
2024-06-18 09:58:08.842 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/_framework/aspnetcore-browser-refresh.js - 200 13770 application/javascript; charset=utf-8 5.0577ms
2024-06-18 09:58:08.870 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/_vs/browserLink - 200 null text/javascript; charset=UTF-8 32.8899ms
2024-06-18 09:58:08.962 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/swagger/v1/swagger.json - null null
2024-06-18 09:58:09.068 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 106.8959ms
2024-06-18 09:59:14.298 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/repair-requests - null null
2024-06-18 09:59:15.608 +03:00 [INF] Executing endpoint 'RepairRequest.Api.Controllers.RepairRequestController.GetAll (RepairRequest.Api)'
2024-06-18 09:59:15.631 +03:00 [INF] Route matched with {action = "GetAll", controller = "RepairRequest"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll(RepairRequest.Application.Query.GetAll.GetListQuery, MediatR.IMediator, System.Threading.CancellationToken) on controller RepairRequest.Api.Controllers.RepairRequestController (RepairRequest.Api).
2024-06-18 09:59:18.146 +03:00 [INF] Executed DbCommand (27ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[LeadTime], [r].[MasterId], [r].[RequestStatusId], [r].[ServiceCenterId], [r].[StatusId], [r].[UserId]
FROM [Requests] AS [r]
ORDER BY [r].[Id]
2024-06-18 09:59:18.199 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[LeadTime], [r].[MasterId], [r].[RequestStatusId], [r].[ServiceCenterId], [r].[StatusId], [r].[UserId]
FROM [Requests] AS [r]
2024-06-18 09:59:18.208 +03:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[RepairRequest.Application.dto.GetRequestsDTO, RepairRequest.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2024-06-18 09:59:18.222 +03:00 [INF] Executed action RepairRequest.Api.Controllers.RepairRequestController.GetAll (RepairRequest.Api) in 2587.2722ms
2024-06-18 09:59:18.223 +03:00 [INF] Executed endpoint 'RepairRequest.Api.Controllers.RepairRequestController.GetAll (RepairRequest.Api)'
2024-06-18 09:59:18.230 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/repair-requests - 200 null application/json; charset=utf-8 3935.9207ms
2024-06-18 10:03:28.584 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7014/repair-requests - application/json 103
2024-06-18 10:03:28.597 +03:00 [INF] Executing endpoint 'RepairRequest.Api.Controllers.RepairRequestController.Post (RepairRequest.Api)'
2024-06-18 10:03:28.601 +03:00 [INF] Route matched with {action = "Post", controller = "RepairRequest"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Post(RepairRequest.Application.Comands.CreateRequest.CreateRequestComand, MediatR.IMediator, System.Threading.CancellationToken) on controller RepairRequest.Api.Controllers.RepairRequestController (RepairRequest.Api).
2024-06-18 10:03:29.070 +03:00 [INF] Executed DbCommand (408ms) [Parameters=[@__request_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Login], [u].[PasswordHash], [u].[Phone]
FROM [Users] AS [u]
WHERE [u].[Id] = @__request_UserId_0
2024-06-18 10:03:29.416 +03:00 [INF] Executed action RepairRequest.Api.Controllers.RepairRequestController.Post (RepairRequest.Api) in 815.3228ms
2024-06-18 10:03:29.417 +03:00 [INF] Executed endpoint 'RepairRequest.Api.Controllers.RepairRequestController.Post (RepairRequest.Api)'
2024-06-18 10:03:29.420 +03:00 [ERR] An unhandled exception has occurred while executing the request.
AutoMapper.AutoMapperMappingException: Error mapping types.

Mapping types:
CreateRequestComand -> RepairRequestEntity
RepairRequest.Application.Comands.CreateRequest.CreateRequestComand -> RepairRequest.Domain.RepairRequestEntity

Type Map configuration:
CreateRequestComand -> RepairRequestEntity
RepairRequest.Application.Comands.CreateRequest.CreateRequestComand -> RepairRequest.Domain.RepairRequestEntity

Destination Member:
Components

 ---> AutoMapper.AutoMapperMappingException: Missing type map configuration or unsupported mapping.

Mapping types:
Int32 -> RepairRequestComponent
System.Int32 -> RepairRequest.Domain.RepairRequestComponent
   at lambda_method90(Closure, Int32, RepairRequestComponent, ResolutionContext)
   at lambda_method89(Closure, CreateRequestComand, RepairRequestEntity, ResolutionContext)
   --- End of inner exception stack trace ---
   at lambda_method89(Closure, CreateRequestComand, RepairRequestEntity, ResolutionContext)
   at RepairRequest.Application.Comands.CreateRequest.CreateRequestComandHendler.Handle(CreateRequestComand request, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequest.Application\Requests\Comands\CreateRequest\CreateRequestComandHendler.cs:line 58
   at RepairRequest.Application.Behaviors.ContextTransactionBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequest.Application\Behaviors\ContextTransactionBehavior.cs:line 20
   at RepairRequest.Application.Behaviors.ContextTransactionBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequest.Application\Behaviors\ContextTransactionBehavior.cs:line 27
   at RepairRequest.Application.Behaviors.ContextTransactionBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequest.Application\Behaviors\ContextTransactionBehavior.cs:line 29
   at RepairRequest.Application.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequest.Application\Behaviors\ValidationBehavior.cs:line 24
   at RepairRequest.Api.Controllers.RepairRequestController.Post(CreateRequestComand item, IMediator mediator, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequestMicroservice\RepairRequest.Api\Controllers\RepairRequestController.cs:line 46
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2024-06-18 10:03:29.471 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7014/repair-requests - 500 null text/plain; charset=utf-8 886.6543ms
2024-06-18 10:04:51.630 +03:00 [INF] User profile is available. Using 'C:\Users\vitia\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-06-18 10:04:51.883 +03:00 [INF] Now listening on: https://localhost:7014
2024-06-18 10:04:51.883 +03:00 [INF] Now listening on: http://localhost:5281
2024-06-18 10:04:51.884 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2024-06-18 10:04:51.884 +03:00 [INF] Hosting environment: Development
2024-06-18 10:04:51.884 +03:00 [INF] Content root path: D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequestMicroservice\RepairRequest.Api
2024-06-18 10:04:52.396 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/swagger/index.html - null null
2024-06-18 10:04:52.655 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/swagger/index.html - 200 null text/html;charset=utf-8 275.8148ms
2024-06-18 10:04:52.682 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/_framework/aspnetcore-browser-refresh.js - null null
2024-06-18 10:04:52.682 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/_vs/browserLink - null null
2024-06-18 10:04:52.688 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/_framework/aspnetcore-browser-refresh.js - 200 13770 application/javascript; charset=utf-8 5.8559ms
2024-06-18 10:04:52.725 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/_vs/browserLink - 200 null text/javascript; charset=UTF-8 42.9079ms
2024-06-18 10:04:52.812 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/swagger/v1/swagger.json - null null
2024-06-18 10:04:52.914 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 102.7908ms
2024-06-18 10:05:16.516 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7014/repair-requests - application/json 103
2024-06-18 10:05:16.639 +03:00 [INF] Executing endpoint 'RepairRequest.Api.Controllers.RepairRequestController.Post (RepairRequest.Api)'
2024-06-18 10:05:16.659 +03:00 [INF] Route matched with {action = "Post", controller = "RepairRequest"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Post(RepairRequest.Application.Comands.CreateRequest.CreateRequestComand, MediatR.IMediator, System.Threading.CancellationToken) on controller RepairRequest.Api.Controllers.RepairRequestController (RepairRequest.Api).
2024-06-18 10:05:56.492 +03:00 [INF] Executed DbCommand (56ms) [Parameters=[@__request_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Login], [u].[PasswordHash], [u].[Phone]
FROM [Users] AS [u]
WHERE [u].[Id] = @__request_UserId_0
2024-06-18 10:07:27.481 +03:00 [INF] Executed action RepairRequest.Api.Controllers.RepairRequestController.Post (RepairRequest.Api) in 130818.8336ms
2024-06-18 10:07:27.482 +03:00 [INF] Executed endpoint 'RepairRequest.Api.Controllers.RepairRequestController.Post (RepairRequest.Api)'
2024-06-18 10:07:27.485 +03:00 [ERR] An unhandled exception has occurred while executing the request.
AutoMapper.AutoMapperMappingException: Error mapping types.

Mapping types:
CreateRequestComand -> RepairRequestEntity
RepairRequest.Application.Comands.CreateRequest.CreateRequestComand -> RepairRequest.Domain.RepairRequestEntity

Type Map configuration:
CreateRequestComand -> RepairRequestEntity
RepairRequest.Application.Comands.CreateRequest.CreateRequestComand -> RepairRequest.Domain.RepairRequestEntity

Destination Member:
Components

 ---> AutoMapper.AutoMapperMappingException: Missing type map configuration or unsupported mapping.

Mapping types:
Int32 -> RepairRequestComponent
System.Int32 -> RepairRequest.Domain.RepairRequestComponent
   at lambda_method76(Closure, Int32, RepairRequestComponent, ResolutionContext)
   at lambda_method75(Closure, CreateRequestComand, RepairRequestEntity, ResolutionContext)
   --- End of inner exception stack trace ---
   at lambda_method75(Closure, CreateRequestComand, RepairRequestEntity, ResolutionContext)
   at RepairRequest.Application.Comands.CreateRequest.CreateRequestComandHendler.Handle(CreateRequestComand request, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequest.Application\Requests\Comands\CreateRequest\CreateRequestComandHendler.cs:line 58
   at RepairRequest.Application.Behaviors.ContextTransactionBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequest.Application\Behaviors\ContextTransactionBehavior.cs:line 20
   at RepairRequest.Application.Behaviors.ContextTransactionBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequest.Application\Behaviors\ContextTransactionBehavior.cs:line 27
   at RepairRequest.Application.Behaviors.ContextTransactionBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequest.Application\Behaviors\ContextTransactionBehavior.cs:line 29
   at RepairRequest.Application.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequest.Application\Behaviors\ValidationBehavior.cs:line 24
   at RepairRequest.Api.Controllers.RepairRequestController.Post(CreateRequestComand item, IMediator mediator, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequestMicroservice\RepairRequest.Api\Controllers\RepairRequestController.cs:line 46
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2024-06-18 10:07:27.613 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7014/repair-requests - 500 null text/plain; charset=utf-8 131097.805ms
2024-06-18 11:26:35.590 +03:00 [INF] User profile is available. Using 'C:\Users\vitia\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-06-18 11:26:35.864 +03:00 [INF] Now listening on: https://localhost:7014
2024-06-18 11:26:35.864 +03:00 [INF] Now listening on: http://localhost:5281
2024-06-18 11:26:35.865 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2024-06-18 11:26:35.866 +03:00 [INF] Hosting environment: Development
2024-06-18 11:26:35.866 +03:00 [INF] Content root path: D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequestMicroservice\RepairRequest.Api
2024-06-18 11:26:36.149 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/swagger/index.html - null null
2024-06-18 11:26:36.372 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/swagger/index.html - 200 null text/html;charset=utf-8 225.3703ms
2024-06-18 11:26:36.377 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/_framework/aspnetcore-browser-refresh.js - null null
2024-06-18 11:26:36.385 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/_framework/aspnetcore-browser-refresh.js - 200 13770 application/javascript; charset=utf-8 8.0659ms
2024-06-18 11:26:36.400 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/_vs/browserLink - null null
2024-06-18 11:26:36.437 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/_vs/browserLink - 200 null text/javascript; charset=UTF-8 37.9904ms
2024-06-18 11:26:36.526 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/swagger/v1/swagger.json - null null
2024-06-18 11:26:36.626 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 100.343ms
2024-06-18 11:26:55.185 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7014/repair-requests - application/json 103
2024-06-18 11:26:56.130 +03:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2024-06-18 11:26:56.133 +03:00 [INF] AuthenticationScheme: Bearer was challenged.
2024-06-18 11:26:56.133 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7014/repair-requests - 401 0 null 948.2195ms
2024-06-18 11:27:09.226 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7014/repair-requests - application/json 103
2024-06-18 11:27:09.302 +03:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '6/18/2024 7:13:22 AM', Current time (UTC): '6/18/2024 8:27:09 AM'.
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2024-06-18 11:27:09.429 +03:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '6/18/2024 7:13:22 AM', Current time (UTC): '6/18/2024 8:27:09 AM'.
2024-06-18 11:27:09.430 +03:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2024-06-18 11:27:09.432 +03:00 [INF] AuthenticationScheme: Bearer was challenged.
2024-06-18 11:27:09.432 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7014/repair-requests - 401 0 null 206.7429ms
2024-06-18 11:27:39.802 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7014/repair-requests - application/json 103
2024-06-18 11:27:39.817 +03:00 [INF] Executing endpoint 'RepairRequest.Api.Controllers.RepairRequestController.Post (RepairRequest.Api)'
2024-06-18 11:27:39.838 +03:00 [INF] Route matched with {action = "Post", controller = "RepairRequest"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Post(RepairRequest.Application.Comands.CreateRequest.CreateRequestComand, MediatR.IMediator, System.Threading.CancellationToken) on controller RepairRequest.Api.Controllers.RepairRequestController (RepairRequest.Api).
2024-06-18 11:27:47.435 +03:00 [INF] Executed DbCommand (92ms) [Parameters=[@__request_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Login], [u].[PasswordHash], [u].[Phone]
FROM [Users] AS [u]
WHERE [u].[Id] = @__request_UserId_0
2024-06-18 11:28:04.161 +03:00 [INF] Executed DbCommand (23ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [r].[Id], [r].[StatusName]
FROM [RequestStatuses] AS [r]
WHERE [r].[StatusName] = N'Issued'
2024-06-18 11:28:15.944 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (DbType = Int32), @p2='?' (DbType = Int32), @p3='?' (DbType = Int32), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Requests] ([LeadTime], [MasterId], [RequestStatusId], [ServiceCenterId], [StatusId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2024-06-18 11:28:16.059 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'RepairRequest.Percistance.AppDBContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Requests_RequestStatuses_RequestStatusId". The conflict occurred in database "CycleServiceDB", table "dbo.RequestStatuses", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:769244d9-a38a-4378-9232-475754a8c695
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Requests_RequestStatuses_RequestStatusId". The conflict occurred in database "CycleServiceDB", table "dbo.RequestStatuses", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:769244d9-a38a-4378-9232-475754a8c695
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2024-06-18 11:28:16.405 +03:00 [INF] Executed action RepairRequest.Api.Controllers.RepairRequestController.Post (RepairRequest.Api) in 36564.5851ms
2024-06-18 11:28:16.406 +03:00 [INF] Executed endpoint 'RepairRequest.Api.Controllers.RepairRequestController.Post (RepairRequest.Api)'
2024-06-18 11:28:16.408 +03:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Requests_RequestStatuses_RequestStatusId". The conflict occurred in database "CycleServiceDB", table "dbo.RequestStatuses", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:769244d9-a38a-4378-9232-475754a8c695
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at RepairRequest.Percistance.SqlServerBaseReository`1.AddAsync(TEntity item, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequestMicroservice\RepairRequest.Percistance\SqlServerBaseReository.cs:line 32
   at RepairRequest.Application.Comands.CreateRequest.CreateRequestComandHendler.Handle(CreateRequestComand request, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequest.Application\Requests\Comands\CreateRequest\CreateRequestComandHendler.cs:line 69
   at RepairRequest.Application.Behaviors.ContextTransactionBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequest.Application\Behaviors\ContextTransactionBehavior.cs:line 20
   at RepairRequest.Application.Behaviors.ContextTransactionBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequest.Application\Behaviors\ContextTransactionBehavior.cs:line 27
   at RepairRequest.Application.Behaviors.ContextTransactionBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequest.Application\Behaviors\ContextTransactionBehavior.cs:line 29
   at RepairRequest.Application.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequest.Application\Behaviors\ValidationBehavior.cs:line 24
   at RepairRequest.Api.Controllers.RepairRequestController.Post(CreateRequestComand item, IMediator mediator, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequestMicroservice\RepairRequest.Api\Controllers\RepairRequestController.cs:line 46
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2024-06-18 11:28:16.505 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7014/repair-requests - 500 null text/plain; charset=utf-8 36703.5464ms
2024-06-18 11:29:01.071 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7014/repair-requests - application/json 103
2024-06-18 11:29:01.102 +03:00 [INF] Executing endpoint 'RepairRequest.Api.Controllers.RepairRequestController.Post (RepairRequest.Api)'
2024-06-18 11:29:01.103 +03:00 [INF] Route matched with {action = "Post", controller = "RepairRequest"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Post(RepairRequest.Application.Comands.CreateRequest.CreateRequestComand, MediatR.IMediator, System.Threading.CancellationToken) on controller RepairRequest.Api.Controllers.RepairRequestController (RepairRequest.Api).
2024-06-18 11:29:03.994 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__request_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Login], [u].[PasswordHash], [u].[Phone]
FROM [Users] AS [u]
WHERE [u].[Id] = @__request_UserId_0
2024-06-18 11:29:03.996 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [r].[Id], [r].[StatusName]
FROM [RequestStatuses] AS [r]
WHERE [r].[StatusName] = N'Issued'
2024-06-18 11:29:04.010 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (DbType = Int32), @p2='?' (DbType = Int32), @p3='?' (DbType = Int32), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Requests] ([LeadTime], [MasterId], [RequestStatusId], [ServiceCenterId], [StatusId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2024-06-18 11:29:04.041 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [RepairRequestService] ([RepairRequestId], [ServiceId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1);
2024-06-18 11:29:04.045 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'RepairRequest.Percistance.AppDBContext'.
System.InvalidOperationException: A second operation was started on this context instance before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
   at Microsoft.EntityFrameworkCore.Infrastructure.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
System.InvalidOperationException: A second operation was started on this context instance before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
   at Microsoft.EntityFrameworkCore.Infrastructure.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2024-06-18 11:29:28.722 +03:00 [INF] User profile is available. Using 'C:\Users\vitia\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-06-18 11:29:28.969 +03:00 [INF] Now listening on: https://localhost:7014
2024-06-18 11:29:28.970 +03:00 [INF] Now listening on: http://localhost:5281
2024-06-18 11:29:28.971 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2024-06-18 11:29:28.971 +03:00 [INF] Hosting environment: Development
2024-06-18 11:29:28.971 +03:00 [INF] Content root path: D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequestMicroservice\RepairRequest.Api
2024-06-18 11:29:29.650 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/swagger/index.html - null null
2024-06-18 11:29:29.852 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/swagger/index.html - 200 null text/html;charset=utf-8 204.2279ms
2024-06-18 11:29:29.860 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/_framework/aspnetcore-browser-refresh.js - null null
2024-06-18 11:29:29.864 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/_framework/aspnetcore-browser-refresh.js - 200 13770 application/javascript; charset=utf-8 4.5268ms
2024-06-18 11:29:29.876 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/_vs/browserLink - null null
2024-06-18 11:29:29.909 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/_vs/browserLink - 200 null text/javascript; charset=UTF-8 33.9336ms
2024-06-18 11:29:29.997 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/swagger/v1/swagger.json - null null
2024-06-18 11:29:30.090 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 92.8015ms
2024-06-18 11:30:00.201 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7014/repair-requests - application/json 103
2024-06-18 11:30:00.315 +03:00 [INF] Executing endpoint 'RepairRequest.Api.Controllers.RepairRequestController.Post (RepairRequest.Api)'
2024-06-18 11:30:00.335 +03:00 [INF] Route matched with {action = "Post", controller = "RepairRequest"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Post(RepairRequest.Application.Comands.CreateRequest.CreateRequestComand, MediatR.IMediator, System.Threading.CancellationToken) on controller RepairRequest.Api.Controllers.RepairRequestController (RepairRequest.Api).
2024-06-18 11:30:01.659 +03:00 [INF] Executed DbCommand (38ms) [Parameters=[@__request_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Login], [u].[PasswordHash], [u].[Phone]
FROM [Users] AS [u]
WHERE [u].[Id] = @__request_UserId_0
2024-06-18 11:30:01.735 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [r].[Id], [r].[StatusName]
FROM [RequestStatuses] AS [r]
WHERE [r].[StatusName] = N'Issued'
2024-06-18 11:30:01.870 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (DbType = Int32), @p2='?' (DbType = Int32), @p3='?' (DbType = Int32), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Requests] ([LeadTime], [MasterId], [RequestStatusId], [ServiceCenterId], [StatusId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2024-06-18 11:30:01.906 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [RepairRequestService] ([RepairRequestId], [ServiceId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1);
2024-06-18 11:30:01.936 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'RepairRequest.Percistance.AppDBContext'.
System.InvalidOperationException: A second operation was started on this context instance before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
   at Microsoft.EntityFrameworkCore.Infrastructure.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
System.InvalidOperationException: A second operation was started on this context instance before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
   at Microsoft.EntityFrameworkCore.Infrastructure.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2024-06-18 11:31:29.649 +03:00 [INF] User profile is available. Using 'C:\Users\vitia\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-06-18 11:31:29.907 +03:00 [INF] Now listening on: https://localhost:7014
2024-06-18 11:31:29.907 +03:00 [INF] Now listening on: http://localhost:5281
2024-06-18 11:31:29.909 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2024-06-18 11:31:29.909 +03:00 [INF] Hosting environment: Development
2024-06-18 11:31:29.909 +03:00 [INF] Content root path: D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequestMicroservice\RepairRequest.Api
2024-06-18 11:31:30.513 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/swagger/index.html - null null
2024-06-18 11:31:30.727 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/swagger/index.html - 200 null text/html;charset=utf-8 216.9469ms
2024-06-18 11:31:30.733 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/_framework/aspnetcore-browser-refresh.js - null null
2024-06-18 11:31:30.741 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/_framework/aspnetcore-browser-refresh.js - 200 13770 application/javascript; charset=utf-8 7.8917ms
2024-06-18 11:31:30.751 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/_vs/browserLink - null null
2024-06-18 11:31:30.809 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/_vs/browserLink - 200 null text/javascript; charset=UTF-8 58.2474ms
2024-06-18 11:31:30.934 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/swagger/v1/swagger.json - null null
2024-06-18 11:31:31.045 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 111.2132ms
2024-06-18 11:32:14.129 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7014/repair-requests - application/json 103
2024-06-18 11:32:14.261 +03:00 [INF] Executing endpoint 'RepairRequest.Api.Controllers.RepairRequestController.Post (RepairRequest.Api)'
2024-06-18 11:32:14.282 +03:00 [INF] Route matched with {action = "Post", controller = "RepairRequest"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Post(RepairRequest.Application.Comands.CreateRequest.CreateRequestComand, MediatR.IMediator, System.Threading.CancellationToken) on controller RepairRequest.Api.Controllers.RepairRequestController (RepairRequest.Api).
2024-06-18 11:32:16.148 +03:00 [INF] Executed DbCommand (38ms) [Parameters=[@__request_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Login], [u].[PasswordHash], [u].[Phone]
FROM [Users] AS [u]
WHERE [u].[Id] = @__request_UserId_0
2024-06-18 11:32:16.220 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [r].[Id], [r].[StatusName]
FROM [RequestStatuses] AS [r]
WHERE [r].[StatusName] = N'Issued'
2024-06-18 11:32:16.357 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (DbType = Int32), @p2='?' (DbType = Int32), @p3='?' (DbType = Int32), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Requests] ([LeadTime], [MasterId], [RequestStatusId], [ServiceCenterId], [StatusId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2024-06-18 11:32:16.392 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [RepairRequestService] ([RepairRequestId], [ServiceId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1);
2024-06-18 11:32:16.396 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [RepairRequestService] ([RepairRequestId], [ServiceId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1);
2024-06-18 11:32:16.408 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [RepairRequestComponent] ([ComponentId], [RepairRequestId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1);
2024-06-18 11:32:16.412 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [RepairRequestComponent] ([ComponentId], [RepairRequestId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1);
2024-06-18 11:32:16.438 +03:00 [INF] Executing CreatedResult, writing value of type 'RepairRequest.Application.dto.GetRequestsDTO'.
2024-06-18 11:32:16.459 +03:00 [INF] Executed action RepairRequest.Api.Controllers.RepairRequestController.Post (RepairRequest.Api) in 2174.395ms
2024-06-18 11:32:16.460 +03:00 [INF] Executed endpoint 'RepairRequest.Api.Controllers.RepairRequestController.Post (RepairRequest.Api)'
2024-06-18 11:32:16.463 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.Text.Json.JsonException: A possible object cycle was detected. This can either be due to a cycle or if the object depth is larger than the maximum allowed depth of 32. Consider using ReferenceHandler.Preserve on JsonSerializerOptions to support cycles. Path: $.Components.RepairRequest.Components.RepairRequest.Components.RepairRequest.Components.RepairRequest.Components.RepairRequest.Components.RepairRequest.Components.RepairRequest.Components.RepairRequest.Components.RepairRequest.Components.RepairRequest.User.Id.
   at System.Text.Json.ThrowHelper.ThrowJsonException_SerializerCycleDetected(Int32 maxDepth)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonCollectionConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonCollectionConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonCollectionConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonCollectionConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonCollectionConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonCollectionConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonCollectionConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonCollectionConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonCollectionConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonCollectionConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.WriteCore(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonTypeInfo`1.SerializeAsync(Stream utf8Json, T rootValue, CancellationToken cancellationToken, Object rootValueBoxed)
   at System.Text.Json.Serialization.Metadata.JsonTypeInfo`1.SerializeAsync(Stream utf8Json, T rootValue, CancellationToken cancellationToken, Object rootValueBoxed)
   at System.Text.Json.Serialization.Metadata.JsonTypeInfo`1.SerializeAsync(Stream utf8Json, T rootValue, CancellationToken cancellationToken, Object rootValueBoxed)
   at Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter.WriteResponseBodyAsync(OutputFormatterWriteContext context, Encoding selectedEncoding)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResultFilterAsync>g__Awaited|30_0[TFilter,TFilterAsync](ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2024-06-18 11:32:16.498 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7014/repair-requests - 500 null text/plain; charset=utf-8 2369.6825ms
2024-06-18 11:33:54.948 +03:00 [INF] User profile is available. Using 'C:\Users\vitia\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-06-18 11:33:55.234 +03:00 [INF] Now listening on: https://localhost:7014
2024-06-18 11:33:55.234 +03:00 [INF] Now listening on: http://localhost:5281
2024-06-18 11:33:55.236 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2024-06-18 11:33:55.236 +03:00 [INF] Hosting environment: Development
2024-06-18 11:33:55.236 +03:00 [INF] Content root path: D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequestMicroservice\RepairRequest.Api
2024-06-18 11:33:55.883 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/swagger/index.html - null null
2024-06-18 11:33:56.109 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/swagger/index.html - 200 null text/html;charset=utf-8 228.7402ms
2024-06-18 11:33:56.119 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/_framework/aspnetcore-browser-refresh.js - null null
2024-06-18 11:33:56.127 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/_framework/aspnetcore-browser-refresh.js - 200 13770 application/javascript; charset=utf-8 8.4173ms
2024-06-18 11:33:56.140 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/_vs/browserLink - null null
2024-06-18 11:33:56.202 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/_vs/browserLink - 200 null text/javascript; charset=UTF-8 62.5368ms
2024-06-18 11:33:56.312 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/swagger/v1/swagger.json - null null
2024-06-18 11:33:56.422 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 110.2067ms
2024-06-18 11:34:21.459 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7014/repair-requests - application/json 103
2024-06-18 11:34:21.574 +03:00 [INF] Executing endpoint 'RepairRequest.Api.Controllers.RepairRequestController.Post (RepairRequest.Api)'
2024-06-18 11:34:21.594 +03:00 [INF] Route matched with {action = "Post", controller = "RepairRequest"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Post(RepairRequest.Application.Comands.CreateRequest.CreateRequestComand, MediatR.IMediator, System.Threading.CancellationToken) on controller RepairRequest.Api.Controllers.RepairRequestController (RepairRequest.Api).
2024-06-18 11:34:22.871 +03:00 [INF] Executed DbCommand (39ms) [Parameters=[@__request_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Login], [u].[PasswordHash], [u].[Phone]
FROM [Users] AS [u]
WHERE [u].[Id] = @__request_UserId_0
2024-06-18 11:34:22.941 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [r].[Id], [r].[StatusName]
FROM [RequestStatuses] AS [r]
WHERE [r].[StatusName] = N'Issued'
2024-06-18 11:34:23.079 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (DbType = Int32), @p2='?' (DbType = Int32), @p3='?' (DbType = Int32), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Requests] ([LeadTime], [MasterId], [RequestStatusId], [ServiceCenterId], [StatusId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2024-06-18 11:34:23.426 +03:00 [INF] Executed action RepairRequest.Api.Controllers.RepairRequestController.Post (RepairRequest.Api) in 1828.887ms
2024-06-18 11:34:23.428 +03:00 [INF] Executed endpoint 'RepairRequest.Api.Controllers.RepairRequestController.Post (RepairRequest.Api)'
2024-06-18 11:34:23.431 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: The entity type 'RepairRequestService' was not found. Ensure that the entity type has been added to the model.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.GetOrCreateEntry(Object entity)
   at Microsoft.EntityFrameworkCore.DbContext.EntryWithoutDetectChanges[TEntity](TEntity entity)
   at Microsoft.EntityFrameworkCore.DbContext.AddAsync[TEntity](TEntity entity, CancellationToken cancellationToken)
   at RepairRequest.Percistance.SqlServerBaseReository`1.AddAsync(TEntity item, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequestMicroservice\RepairRequest.Percistance\SqlServerBaseReository.cs:line 31
   at RepairRequest.Application.Comands.CreateRequest.CreateRequestComandHendler.Handle(CreateRequestComand request, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequest.Application\Requests\Comands\CreateRequest\CreateRequestComandHendler.cs:line 79
   at RepairRequest.Application.Behaviors.ContextTransactionBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequest.Application\Behaviors\ContextTransactionBehavior.cs:line 20
   at RepairRequest.Application.Behaviors.ContextTransactionBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequest.Application\Behaviors\ContextTransactionBehavior.cs:line 27
   at RepairRequest.Application.Behaviors.ContextTransactionBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequest.Application\Behaviors\ContextTransactionBehavior.cs:line 29
   at RepairRequest.Application.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequest.Application\Behaviors\ValidationBehavior.cs:line 24
   at RepairRequest.Api.Controllers.RepairRequestController.Post(CreateRequestComand item, IMediator mediator, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequestMicroservice\RepairRequest.Api\Controllers\RepairRequestController.cs:line 46
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2024-06-18 11:34:23.479 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7014/repair-requests - 500 null text/plain; charset=utf-8 2020.4271ms
2024-06-18 11:35:02.511 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7014/repair-requests - application/json 103
2024-06-18 11:35:02.514 +03:00 [INF] Executing endpoint 'RepairRequest.Api.Controllers.RepairRequestController.Post (RepairRequest.Api)'
2024-06-18 11:35:02.515 +03:00 [INF] Route matched with {action = "Post", controller = "RepairRequest"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Post(RepairRequest.Application.Comands.CreateRequest.CreateRequestComand, MediatR.IMediator, System.Threading.CancellationToken) on controller RepairRequest.Api.Controllers.RepairRequestController (RepairRequest.Api).
2024-06-18 11:35:06.950 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Login], [u].[PasswordHash], [u].[Phone]
FROM [Users] AS [u]
WHERE [u].[Id] = @__request_UserId_0
2024-06-18 11:35:17.565 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [r].[Id], [r].[StatusName]
FROM [RequestStatuses] AS [r]
WHERE [r].[StatusName] = N'Issued'
2024-06-18 11:35:22.180 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (DbType = Int32), @p2='?' (DbType = Int32), @p3='?' (DbType = Int32), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Requests] ([LeadTime], [MasterId], [RequestStatusId], [ServiceCenterId], [StatusId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2024-06-18 11:35:33.870 +03:00 [INF] Executed action RepairRequest.Api.Controllers.RepairRequestController.Post (RepairRequest.Api) in 31355.2984ms
2024-06-18 11:35:33.871 +03:00 [INF] Executed endpoint 'RepairRequest.Api.Controllers.RepairRequestController.Post (RepairRequest.Api)'
2024-06-18 11:35:33.872 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: The entity type 'RepairRequestService' was not found. Ensure that the entity type has been added to the model.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.GetOrCreateEntry(Object entity)
   at Microsoft.EntityFrameworkCore.DbContext.EntryWithoutDetectChanges[TEntity](TEntity entity)
   at Microsoft.EntityFrameworkCore.DbContext.AddAsync[TEntity](TEntity entity, CancellationToken cancellationToken)
   at RepairRequest.Percistance.SqlServerBaseReository`1.AddAsync(TEntity item, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequestMicroservice\RepairRequest.Percistance\SqlServerBaseReository.cs:line 31
   at RepairRequest.Application.Comands.CreateRequest.CreateRequestComandHendler.Handle(CreateRequestComand request, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequest.Application\Requests\Comands\CreateRequest\CreateRequestComandHendler.cs:line 79
   at RepairRequest.Application.Behaviors.ContextTransactionBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequest.Application\Behaviors\ContextTransactionBehavior.cs:line 20
   at RepairRequest.Application.Behaviors.ContextTransactionBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequest.Application\Behaviors\ContextTransactionBehavior.cs:line 27
   at RepairRequest.Application.Behaviors.ContextTransactionBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequest.Application\Behaviors\ContextTransactionBehavior.cs:line 29
   at RepairRequest.Application.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequest.Application\Behaviors\ValidationBehavior.cs:line 24
   at RepairRequest.Api.Controllers.RepairRequestController.Post(CreateRequestComand item, IMediator mediator, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequestMicroservice\RepairRequest.Api\Controllers\RepairRequestController.cs:line 46
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2024-06-18 11:35:33.876 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7014/repair-requests - 500 null text/plain; charset=utf-8 31365.3986ms
2024-06-18 11:36:56.292 +03:00 [INF] User profile is available. Using 'C:\Users\vitia\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-06-18 11:36:56.549 +03:00 [INF] Now listening on: https://localhost:7014
2024-06-18 11:36:56.549 +03:00 [INF] Now listening on: http://localhost:5281
2024-06-18 11:36:56.550 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2024-06-18 11:36:56.550 +03:00 [INF] Hosting environment: Development
2024-06-18 11:36:56.551 +03:00 [INF] Content root path: D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequestMicroservice\RepairRequest.Api
2024-06-18 11:36:56.869 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/swagger/index.html - null null
2024-06-18 11:36:57.112 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/swagger/index.html - 200 null text/html;charset=utf-8 253.5961ms
2024-06-18 11:36:57.117 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/_framework/aspnetcore-browser-refresh.js - null null
2024-06-18 11:36:57.125 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/_framework/aspnetcore-browser-refresh.js - 200 13770 application/javascript; charset=utf-8 8.2855ms
2024-06-18 11:36:57.131 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/_vs/browserLink - null null
2024-06-18 11:36:57.176 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/_vs/browserLink - 200 null text/javascript; charset=UTF-8 44.753ms
2024-06-18 11:36:57.279 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/swagger/v1/swagger.json - null null
2024-06-18 11:36:57.379 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 100.0295ms
2024-06-18 11:37:26.774 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7014/repair-requests - application/json 103
2024-06-18 11:37:26.896 +03:00 [INF] Executing endpoint 'RepairRequest.Api.Controllers.RepairRequestController.Post (RepairRequest.Api)'
2024-06-18 11:37:26.915 +03:00 [INF] Route matched with {action = "Post", controller = "RepairRequest"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Post(RepairRequest.Application.Comands.CreateRequest.CreateRequestComand, MediatR.IMediator, System.Threading.CancellationToken) on controller RepairRequest.Api.Controllers.RepairRequestController (RepairRequest.Api).
2024-06-18 11:37:32.092 +03:00 [INF] Executed DbCommand (56ms) [Parameters=[@__request_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Login], [u].[PasswordHash], [u].[Phone]
FROM [Users] AS [u]
WHERE [u].[Id] = @__request_UserId_0
2024-06-18 11:37:38.511 +03:00 [INF] Executed DbCommand (30ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [r].[Id], [r].[StatusName]
FROM [RequestStatuses] AS [r]
WHERE [r].[StatusName] = N'Issued'
2024-06-18 11:37:43.163 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (DbType = Int32), @p2='?' (DbType = Int32), @p3='?' (DbType = Int32), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Requests] ([LeadTime], [MasterId], [RequestStatusId], [ServiceCenterId], [StatusId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2024-06-18 11:37:49.562 +03:00 [ERR] Failed executing DbCommand (24ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [RepairRequestsService] ([RepairRequestId], [ServiceId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1);
2024-06-18 11:37:49.594 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'RepairRequest.Percistance.AppDBContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid object name 'RepairRequestsService'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:834d5eb2-0a75-4037-9675-feb27b65dd95
Error Number:208,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid object name 'RepairRequestsService'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:834d5eb2-0a75-4037-9675-feb27b65dd95
Error Number:208,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2024-06-18 11:37:49.922 +03:00 [INF] Executed action RepairRequest.Api.Controllers.RepairRequestController.Post (RepairRequest.Api) in 23004.7709ms
2024-06-18 11:37:49.923 +03:00 [INF] Executed endpoint 'RepairRequest.Api.Controllers.RepairRequestController.Post (RepairRequest.Api)'
2024-06-18 11:37:49.927 +03:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid object name 'RepairRequestsService'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:834d5eb2-0a75-4037-9675-feb27b65dd95
Error Number:208,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at RepairRequest.Percistance.SqlServerBaseReository`1.AddAsync(TEntity item, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequestMicroservice\RepairRequest.Percistance\SqlServerBaseReository.cs:line 32
   at RepairRequest.Application.Comands.CreateRequest.CreateRequestComandHendler.Handle(CreateRequestComand request, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequest.Application\Requests\Comands\CreateRequest\CreateRequestComandHendler.cs:line 79
   at RepairRequest.Application.Behaviors.ContextTransactionBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequest.Application\Behaviors\ContextTransactionBehavior.cs:line 20
   at RepairRequest.Application.Behaviors.ContextTransactionBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequest.Application\Behaviors\ContextTransactionBehavior.cs:line 27
   at RepairRequest.Application.Behaviors.ContextTransactionBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequest.Application\Behaviors\ContextTransactionBehavior.cs:line 29
   at RepairRequest.Application.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequest.Application\Behaviors\ValidationBehavior.cs:line 24
   at RepairRequest.Api.Controllers.RepairRequestController.Post(CreateRequestComand item, IMediator mediator, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequestMicroservice\RepairRequest.Api\Controllers\RepairRequestController.cs:line 46
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2024-06-18 11:37:50.022 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7014/repair-requests - 500 null text/plain; charset=utf-8 23247.8148ms
2024-06-18 11:39:40.163 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2024-06-18 11:39:40.199 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2024-06-18 11:39:40.201 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2024-06-18 11:39:40.201 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2024-06-18 11:39:40.213 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2024-06-18 11:39:40.224 +03:00 [INF] Applying migration '20240618083923_RequestServiceComponent'.
2024-06-18 11:39:40.262 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [RepairRequestComponent] DROP CONSTRAINT [FK_RepairRequestComponent_Components_ComponentId];
2024-06-18 11:39:40.263 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [RepairRequestComponent] DROP CONSTRAINT [FK_RepairRequestComponent_Requests_RepairRequestId];
2024-06-18 11:39:40.264 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [RepairRequestService] DROP CONSTRAINT [FK_RepairRequestService_Requests_RepairRequestId];
2024-06-18 11:39:40.265 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [RepairRequestService] DROP CONSTRAINT [FK_RepairRequestService_Services_ServiceId];
2024-06-18 11:39:40.270 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [RepairRequestService] DROP CONSTRAINT [PK_RepairRequestService];
2024-06-18 11:39:40.270 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DROP INDEX [IX_RepairRequestService_RepairRequestId] ON [RepairRequestService];
2024-06-18 11:39:40.271 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DROP INDEX [IX_RepairRequestService_ServiceId] ON [RepairRequestService];
2024-06-18 11:39:40.275 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [RepairRequestComponent] DROP CONSTRAINT [PK_RepairRequestComponent];
2024-06-18 11:39:40.275 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DROP INDEX [IX_RepairRequestComponent_ComponentId] ON [RepairRequestComponent];
2024-06-18 11:39:40.276 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DROP INDEX [IX_RepairRequestComponent_RepairRequestId] ON [RepairRequestComponent];
2024-06-18 11:39:40.392 +03:00 [INF] Executed DbCommand (115ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
EXEC sp_rename N'[RepairRequestService]', N'RepairRequestsService';
2024-06-18 11:39:40.393 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
EXEC sp_rename N'[RepairRequestComponent]', N'RepairRequestsComponent';
2024-06-18 11:39:40.396 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [RepairRequestsService] ADD CONSTRAINT [PK_RepairRequestsService] PRIMARY KEY ([Id]);
2024-06-18 11:39:40.398 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [RepairRequestsComponent] ADD CONSTRAINT [PK_RepairRequestsComponent] PRIMARY KEY ([Id]);
2024-06-18 11:39:40.399 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20240618083923_RequestServiceComponent', N'8.0.4');
2024-06-18 11:43:09.633 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2024-06-18 11:43:09.670 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2024-06-18 11:43:09.672 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2024-06-18 11:43:09.672 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2024-06-18 11:43:09.682 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2024-06-18 11:43:09.692 +03:00 [INF] Applying migration '20240618084303_RequestServiceComponentFix'.
2024-06-18 11:43:09.731 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_RepairRequestsService_RepairRequestId] ON [RepairRequestsService] ([RepairRequestId]);
2024-06-18 11:43:09.732 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_RepairRequestsService_ServiceId] ON [RepairRequestsService] ([ServiceId]);
2024-06-18 11:43:09.734 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_RepairRequestsComponent_ComponentId] ON [RepairRequestsComponent] ([ComponentId]);
2024-06-18 11:43:09.735 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_RepairRequestsComponent_RepairRequestId] ON [RepairRequestsComponent] ([RepairRequestId]);
2024-06-18 11:43:09.738 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [RepairRequestsComponent] ADD CONSTRAINT [FK_RepairRequestsComponent_Components_ComponentId] FOREIGN KEY ([ComponentId]) REFERENCES [Components] ([Id]) ON DELETE CASCADE;
2024-06-18 11:43:09.740 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [RepairRequestsComponent] ADD CONSTRAINT [FK_RepairRequestsComponent_Requests_RepairRequestId] FOREIGN KEY ([RepairRequestId]) REFERENCES [Requests] ([Id]) ON DELETE CASCADE;
2024-06-18 11:43:09.741 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [RepairRequestsService] ADD CONSTRAINT [FK_RepairRequestsService_Requests_RepairRequestId] FOREIGN KEY ([RepairRequestId]) REFERENCES [Requests] ([Id]) ON DELETE CASCADE;
2024-06-18 11:43:09.743 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [RepairRequestsService] ADD CONSTRAINT [FK_RepairRequestsService_Services_ServiceId] FOREIGN KEY ([ServiceId]) REFERENCES [Services] ([Id]) ON DELETE CASCADE;
2024-06-18 11:43:09.744 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20240618084303_RequestServiceComponentFix', N'8.0.4');
2024-06-18 11:44:28.915 +03:00 [INF] User profile is available. Using 'C:\Users\vitia\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-06-18 11:44:29.184 +03:00 [INF] Now listening on: https://localhost:7014
2024-06-18 11:44:29.184 +03:00 [INF] Now listening on: http://localhost:5281
2024-06-18 11:44:29.185 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2024-06-18 11:44:29.186 +03:00 [INF] Hosting environment: Development
2024-06-18 11:44:29.186 +03:00 [INF] Content root path: D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequestMicroservice\RepairRequest.Api
2024-06-18 11:44:29.772 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/swagger/index.html - null null
2024-06-18 11:44:29.986 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/swagger/index.html - 200 null text/html;charset=utf-8 222.2249ms
2024-06-18 11:44:30.011 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/_vs/browserLink - null null
2024-06-18 11:44:30.011 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/_framework/aspnetcore-browser-refresh.js - null null
2024-06-18 11:44:30.015 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/_framework/aspnetcore-browser-refresh.js - 200 13770 application/javascript; charset=utf-8 4.2863ms
2024-06-18 11:44:30.057 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/_vs/browserLink - 200 null text/javascript; charset=UTF-8 45.6602ms
2024-06-18 11:44:30.150 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/swagger/v1/swagger.json - null null
2024-06-18 11:44:30.252 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 103.1578ms
2024-06-18 11:45:15.045 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7014/repair-requests - application/json 103
2024-06-18 11:45:15.181 +03:00 [INF] Executing endpoint 'RepairRequest.Api.Controllers.RepairRequestController.Post (RepairRequest.Api)'
2024-06-18 11:45:15.204 +03:00 [INF] Route matched with {action = "Post", controller = "RepairRequest"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Post(RepairRequest.Application.Comands.CreateRequest.CreateRequestComand, MediatR.IMediator, System.Threading.CancellationToken) on controller RepairRequest.Api.Controllers.RepairRequestController (RepairRequest.Api).
2024-06-18 11:45:20.767 +03:00 [INF] Executed DbCommand (40ms) [Parameters=[@__request_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Login], [u].[PasswordHash], [u].[Phone]
FROM [Users] AS [u]
WHERE [u].[Id] = @__request_UserId_0
2024-06-18 11:45:20.841 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [r].[Id], [r].[StatusName]
FROM [RequestStatuses] AS [r]
WHERE [r].[StatusName] = N'Issued'
2024-06-18 11:45:20.980 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (DbType = Int32), @p2='?' (DbType = Int32), @p3='?' (DbType = Int32), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Requests] ([LeadTime], [MasterId], [RequestStatusId], [ServiceCenterId], [StatusId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2024-06-18 11:45:21.010 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [RepairRequestsService] ([RepairRequestId], [ServiceId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1);
2024-06-18 11:45:21.015 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [RepairRequestsService] ([RepairRequestId], [ServiceId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1);
2024-06-18 11:45:21.026 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [RepairRequestsComponent] ([ComponentId], [RepairRequestId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1);
2024-06-18 11:45:21.029 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [RepairRequestsComponent] ([ComponentId], [RepairRequestId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1);
2024-06-18 11:45:21.052 +03:00 [INF] Executing CreatedResult, writing value of type 'RepairRequest.Application.dto.GetRequestsDTO'.
2024-06-18 11:45:21.066 +03:00 [INF] Executed action RepairRequest.Api.Controllers.RepairRequestController.Post (RepairRequest.Api) in 5859.0604ms
2024-06-18 11:45:21.067 +03:00 [INF] Executed endpoint 'RepairRequest.Api.Controllers.RepairRequestController.Post (RepairRequest.Api)'
2024-06-18 11:45:21.073 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7014/repair-requests - 201 null application/json; charset=utf-8 6028.6789ms
2024-06-18 11:48:50.288 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7014/repair-requests - application/json 103
2024-06-18 11:48:50.294 +03:00 [INF] Executing endpoint 'RepairRequest.Api.Controllers.RepairRequestController.Post (RepairRequest.Api)'
2024-06-18 11:48:50.295 +03:00 [INF] Route matched with {action = "Post", controller = "RepairRequest"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Post(RepairRequest.Application.Comands.CreateRequest.CreateRequestComand, MediatR.IMediator, System.Threading.CancellationToken) on controller RepairRequest.Api.Controllers.RepairRequestController (RepairRequest.Api).
2024-06-18 11:48:50.316 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Login], [u].[PasswordHash], [u].[Phone]
FROM [Users] AS [u]
WHERE [u].[Id] = @__request_UserId_0
2024-06-18 11:48:50.318 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [r].[Id], [r].[StatusName]
FROM [RequestStatuses] AS [r]
WHERE [r].[StatusName] = N'Issued'
2024-06-18 11:48:50.323 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (DbType = Int32), @p2='?' (DbType = Int32), @p3='?' (DbType = Int32), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Requests] ([LeadTime], [MasterId], [RequestStatusId], [ServiceCenterId], [StatusId], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2024-06-18 11:48:50.325 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [RepairRequestsService] ([RepairRequestId], [ServiceId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1);
2024-06-18 11:48:50.327 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [RepairRequestsService] ([RepairRequestId], [ServiceId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1);
2024-06-18 11:48:50.330 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [RepairRequestsComponent] ([ComponentId], [RepairRequestId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1);
2024-06-18 11:48:50.332 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [RepairRequestsComponent] ([ComponentId], [RepairRequestId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1);
2024-06-18 11:48:50.334 +03:00 [INF] Executing CreatedResult, writing value of type 'RepairRequest.Application.dto.GetRequestsDTO'.
2024-06-18 11:48:50.334 +03:00 [INF] Executed action RepairRequest.Api.Controllers.RepairRequestController.Post (RepairRequest.Api) in 39.3341ms
2024-06-18 11:48:50.334 +03:00 [INF] Executed endpoint 'RepairRequest.Api.Controllers.RepairRequestController.Post (RepairRequest.Api)'
2024-06-18 11:48:50.334 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7014/repair-requests - 201 null application/json; charset=utf-8 50.7329ms
2024-06-18 11:53:20.217 +03:00 [INF] User profile is available. Using 'C:\Users\vitia\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-06-18 11:53:20.481 +03:00 [INF] Now listening on: https://localhost:7014
2024-06-18 11:53:20.481 +03:00 [INF] Now listening on: http://localhost:5281
2024-06-18 11:53:20.483 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2024-06-18 11:53:20.483 +03:00 [INF] Hosting environment: Development
2024-06-18 11:53:20.483 +03:00 [INF] Content root path: D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequestMicroservice\RepairRequest.Api
2024-06-18 11:53:21.212 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/swagger/index.html - null null
2024-06-18 11:53:21.402 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/swagger/index.html - 200 null text/html;charset=utf-8 194.36ms
2024-06-18 11:53:21.410 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/_framework/aspnetcore-browser-refresh.js - null null
2024-06-18 11:53:21.415 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/_framework/aspnetcore-browser-refresh.js - 200 13770 application/javascript; charset=utf-8 4.989ms
2024-06-18 11:53:21.424 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/_vs/browserLink - null null
2024-06-18 11:53:21.459 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/_vs/browserLink - 200 null text/javascript; charset=UTF-8 35.7523ms
2024-06-18 11:53:21.552 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/swagger/v1/swagger.json - null null
2024-06-18 11:53:21.667 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 114.7368ms
2024-06-18 11:53:57.576 +03:00 [INF] Request starting HTTP/2 PUT https://localhost:7014/repair-requests/accept-request - application/json 30
2024-06-18 11:53:57.705 +03:00 [INF] Executing endpoint 'RepairRequest.Api.Controllers.RepairRequestController.AcceptRequest (RepairRequest.Api)'
2024-06-18 11:53:57.725 +03:00 [INF] Route matched with {action = "AcceptRequest", controller = "RepairRequest"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AcceptRequest(RepairRequest.Application.Requests.Comands.AcceptRequest.AcceptRequestComand, MediatR.IMediator, System.Threading.CancellationToken) on controller RepairRequest.Api.Controllers.RepairRequestController (RepairRequest.Api).
2024-06-18 11:53:57.855 +03:00 [INF] Executed action RepairRequest.Api.Controllers.RepairRequestController.AcceptRequest (RepairRequest.Api) in 126.7675ms
2024-06-18 11:53:57.855 +03:00 [INF] Executed endpoint 'RepairRequest.Api.Controllers.RepairRequestController.AcceptRequest (RepairRequest.Api)'
2024-06-18 11:53:57.858 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: Unable to resolve service for type 'FluentValidation.IValidator`1[RepairRequest.Application.Requests.Comands.AcceptRequest.AcceptRequestComand]' while attempting to activate 'RepairRequest.Application.Behaviors.ValidationBehavior`2[RepairRequest.Application.Requests.Comands.AcceptRequest.AcceptRequestComand,RepairRequest.Application.dto.GetRequestsDTO]'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateOpenGeneric(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot, Boolean throwOnConstraintViolation)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateEnumerable(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at MediatR.Wrappers.RequestHandlerWrapperImpl`2.Handle(IRequest`1 request, IServiceProvider serviceProvider, CancellationToken cancellationToken)
   at MediatR.Mediator.Send[TResponse](IRequest`1 request, CancellationToken cancellationToken)
   at RepairRequest.Api.Controllers.RepairRequestController.AcceptRequest(AcceptRequestComand command, IMediator mediator, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequestMicroservice\RepairRequest.Api\Controllers\RepairRequestController.cs:line 68
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2024-06-18 11:53:57.924 +03:00 [INF] Request finished HTTP/2 PUT https://localhost:7014/repair-requests/accept-request - 500 null text/plain; charset=utf-8 349.3132ms
2024-06-18 11:54:26.440 +03:00 [INF] User profile is available. Using 'C:\Users\vitia\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-06-18 11:54:26.690 +03:00 [INF] Now listening on: https://localhost:7014
2024-06-18 11:54:26.690 +03:00 [INF] Now listening on: http://localhost:5281
2024-06-18 11:54:26.691 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2024-06-18 11:54:26.691 +03:00 [INF] Hosting environment: Development
2024-06-18 11:54:26.692 +03:00 [INF] Content root path: D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequestMicroservice\RepairRequest.Api
2024-06-18 11:54:27.384 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/swagger/index.html - null null
2024-06-18 11:54:27.572 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/swagger/index.html - 200 null text/html;charset=utf-8 189.4228ms
2024-06-18 11:54:27.582 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/_framework/aspnetcore-browser-refresh.js - null null
2024-06-18 11:54:27.588 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/_framework/aspnetcore-browser-refresh.js - 200 13770 application/javascript; charset=utf-8 5.8856ms
2024-06-18 11:54:27.592 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/_vs/browserLink - null null
2024-06-18 11:54:27.631 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/_vs/browserLink - 200 null text/javascript; charset=UTF-8 38.6077ms
2024-06-18 11:54:27.729 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/swagger/v1/swagger.json - null null
2024-06-18 11:54:27.829 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 100.1497ms
2024-06-18 11:54:45.815 +03:00 [INF] Request starting HTTP/2 PUT https://localhost:7014/repair-requests/accept-request - application/json 30
2024-06-18 11:54:45.935 +03:00 [INF] Executing endpoint 'RepairRequest.Api.Controllers.RepairRequestController.AcceptRequest (RepairRequest.Api)'
2024-06-18 11:54:45.955 +03:00 [INF] Route matched with {action = "AcceptRequest", controller = "RepairRequest"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AcceptRequest(RepairRequest.Application.Requests.Comands.AcceptRequest.AcceptRequestComand, MediatR.IMediator, System.Threading.CancellationToken) on controller RepairRequest.Api.Controllers.RepairRequestController (RepairRequest.Api).
2024-06-18 11:54:47.245 +03:00 [INF] Executed DbCommand (39ms) [Parameters=[@__request_MasterId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Login], [u].[PasswordHash], [u].[Phone]
FROM [Users] AS [u]
WHERE [u].[Id] = @__request_MasterId_0
2024-06-18 11:54:47.558 +03:00 [INF] Executed action RepairRequest.Api.Controllers.RepairRequestController.AcceptRequest (RepairRequest.Api) in 1600.3038ms
2024-06-18 11:54:47.559 +03:00 [INF] Executed endpoint 'RepairRequest.Api.Controllers.RepairRequestController.AcceptRequest (RepairRequest.Api)'
2024-06-18 11:54:47.562 +03:00 [ERR] An unhandled exception has occurred while executing the request.
RepairRequest.Service.Exeptions.NotFoundExeption: Not found by filter: "Master not found"
   at RepairRequest.Application.Requests.Comands.AcceptRequest.AcceptRequestComandHandler.Handle(AcceptRequestComand request, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequest.Application\Requests\Comands\AcceptRequest\AcceptRequestComandHandler.cs:line 60
   at RepairRequest.Application.Behaviors.ContextTransactionBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequest.Application\Behaviors\ContextTransactionBehavior.cs:line 20
   at RepairRequest.Application.Behaviors.ContextTransactionBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequest.Application\Behaviors\ContextTransactionBehavior.cs:line 27
   at RepairRequest.Application.Behaviors.ContextTransactionBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequest.Application\Behaviors\ContextTransactionBehavior.cs:line 29
   at RepairRequest.Application.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequest.Application\Behaviors\ValidationBehavior.cs:line 24
   at RepairRequest.Api.Controllers.RepairRequestController.AcceptRequest(AcceptRequestComand command, IMediator mediator, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequestMicroservice\RepairRequest.Api\Controllers\RepairRequestController.cs:line 68
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2024-06-18 11:54:47.605 +03:00 [INF] Request finished HTTP/2 PUT https://localhost:7014/repair-requests/accept-request - 500 null text/plain; charset=utf-8 1790.5389ms
2024-06-18 11:54:59.705 +03:00 [INF] Request starting HTTP/2 PUT https://localhost:7014/repair-requests/accept-request - application/json 30
2024-06-18 11:54:59.709 +03:00 [INF] Executing endpoint 'RepairRequest.Api.Controllers.RepairRequestController.AcceptRequest (RepairRequest.Api)'
2024-06-18 11:54:59.709 +03:00 [INF] Route matched with {action = "AcceptRequest", controller = "RepairRequest"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AcceptRequest(RepairRequest.Application.Requests.Comands.AcceptRequest.AcceptRequestComand, MediatR.IMediator, System.Threading.CancellationToken) on controller RepairRequest.Api.Controllers.RepairRequestController (RepairRequest.Api).
2024-06-18 11:54:59.737 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__request_MasterId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Login], [u].[PasswordHash], [u].[Phone]
FROM [Users] AS [u]
WHERE [u].[Id] = @__request_MasterId_0
2024-06-18 11:54:59.934 +03:00 [INF] Executed action RepairRequest.Api.Controllers.RepairRequestController.AcceptRequest (RepairRequest.Api) in 224.3724ms
2024-06-18 11:54:59.934 +03:00 [INF] Executed endpoint 'RepairRequest.Api.Controllers.RepairRequestController.AcceptRequest (RepairRequest.Api)'
2024-06-18 11:54:59.935 +03:00 [ERR] An unhandled exception has occurred while executing the request.
RepairRequest.Service.Exeptions.NotFoundExeption: Not found by filter: "Master not found"
   at RepairRequest.Application.Requests.Comands.AcceptRequest.AcceptRequestComandHandler.Handle(AcceptRequestComand request, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequest.Application\Requests\Comands\AcceptRequest\AcceptRequestComandHandler.cs:line 60
   at RepairRequest.Application.Behaviors.ContextTransactionBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequest.Application\Behaviors\ContextTransactionBehavior.cs:line 20
   at RepairRequest.Application.Behaviors.ContextTransactionBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequest.Application\Behaviors\ContextTransactionBehavior.cs:line 27
   at RepairRequest.Application.Behaviors.ContextTransactionBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequest.Application\Behaviors\ContextTransactionBehavior.cs:line 29
   at RepairRequest.Application.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequest.Application\Behaviors\ValidationBehavior.cs:line 24
   at RepairRequest.Api.Controllers.RepairRequestController.AcceptRequest(AcceptRequestComand command, IMediator mediator, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequestMicroservice\RepairRequest.Api\Controllers\RepairRequestController.cs:line 68
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2024-06-18 11:54:59.938 +03:00 [INF] Request finished HTTP/2 PUT https://localhost:7014/repair-requests/accept-request - 500 null text/plain; charset=utf-8 233.429ms
2024-06-18 11:55:47.795 +03:00 [INF] Request starting HTTP/2 PUT https://localhost:7014/repair-requests/accept-request - application/json 30
2024-06-18 11:55:47.806 +03:00 [INF] Executing endpoint 'RepairRequest.Api.Controllers.RepairRequestController.AcceptRequest (RepairRequest.Api)'
2024-06-18 11:55:47.807 +03:00 [INF] Route matched with {action = "AcceptRequest", controller = "RepairRequest"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AcceptRequest(RepairRequest.Application.Requests.Comands.AcceptRequest.AcceptRequestComand, MediatR.IMediator, System.Threading.CancellationToken) on controller RepairRequest.Api.Controllers.RepairRequestController (RepairRequest.Api).
2024-06-18 11:56:12.414 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_MasterId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Login], [u].[PasswordHash], [u].[Phone]
FROM [Users] AS [u]
WHERE [u].[Id] = @__request_MasterId_0
2024-06-18 11:56:14.541 +03:00 [INF] Executed action RepairRequest.Api.Controllers.RepairRequestController.AcceptRequest (RepairRequest.Api) in 26733.5914ms
2024-06-18 11:56:14.542 +03:00 [INF] Executed endpoint 'RepairRequest.Api.Controllers.RepairRequestController.AcceptRequest (RepairRequest.Api)'
2024-06-18 11:56:14.542 +03:00 [ERR] An unhandled exception has occurred while executing the request.
RepairRequest.Service.Exeptions.NotFoundExeption: Not found by filter: "Master not found"
   at RepairRequest.Application.Requests.Comands.AcceptRequest.AcceptRequestComandHandler.Handle(AcceptRequestComand request, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequest.Application\Requests\Comands\AcceptRequest\AcceptRequestComandHandler.cs:line 60
   at RepairRequest.Application.Behaviors.ContextTransactionBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequest.Application\Behaviors\ContextTransactionBehavior.cs:line 20
   at RepairRequest.Application.Behaviors.ContextTransactionBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequest.Application\Behaviors\ContextTransactionBehavior.cs:line 27
   at RepairRequest.Application.Behaviors.ContextTransactionBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequest.Application\Behaviors\ContextTransactionBehavior.cs:line 29
   at RepairRequest.Application.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequest.Application\Behaviors\ValidationBehavior.cs:line 24
   at RepairRequest.Api.Controllers.RepairRequestController.AcceptRequest(AcceptRequestComand command, IMediator mediator, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequestMicroservice\RepairRequest.Api\Controllers\RepairRequestController.cs:line 68
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2024-06-18 11:56:14.547 +03:00 [INF] Request finished HTTP/2 PUT https://localhost:7014/repair-requests/accept-request - 500 null text/plain; charset=utf-8 26750.9362ms
2024-06-18 11:56:51.644 +03:00 [INF] User profile is available. Using 'C:\Users\vitia\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-06-18 11:56:51.927 +03:00 [INF] Now listening on: https://localhost:7014
2024-06-18 11:56:51.927 +03:00 [INF] Now listening on: http://localhost:5281
2024-06-18 11:56:51.929 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2024-06-18 11:56:51.929 +03:00 [INF] Hosting environment: Development
2024-06-18 11:56:51.929 +03:00 [INF] Content root path: D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequestMicroservice\RepairRequest.Api
2024-06-18 11:56:52.647 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/swagger/index.html - null null
2024-06-18 11:56:52.842 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/swagger/index.html - 200 null text/html;charset=utf-8 200.7525ms
2024-06-18 11:56:52.848 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/_framework/aspnetcore-browser-refresh.js - null null
2024-06-18 11:56:52.852 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/_framework/aspnetcore-browser-refresh.js - 200 13770 application/javascript; charset=utf-8 4.833ms
2024-06-18 11:56:52.861 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/_vs/browserLink - null null
2024-06-18 11:56:52.913 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/_vs/browserLink - 200 null text/javascript; charset=UTF-8 52.4608ms
2024-06-18 11:56:53.012 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/swagger/v1/swagger.json - null null
2024-06-18 11:56:53.131 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 118.564ms
2024-06-18 11:57:10.814 +03:00 [INF] Request starting HTTP/2 PUT https://localhost:7014/repair-requests/accept-request - application/json 30
2024-06-18 11:57:10.932 +03:00 [INF] Executing endpoint 'RepairRequest.Api.Controllers.RepairRequestController.AcceptRequest (RepairRequest.Api)'
2024-06-18 11:57:10.951 +03:00 [INF] Route matched with {action = "AcceptRequest", controller = "RepairRequest"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AcceptRequest(RepairRequest.Application.Requests.Comands.AcceptRequest.AcceptRequestComand, MediatR.IMediator, System.Threading.CancellationToken) on controller RepairRequest.Api.Controllers.RepairRequestController (RepairRequest.Api).
2024-06-18 11:57:18.201 +03:00 [INF] Executed DbCommand (56ms) [Parameters=[@__request_MasterId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Login], [u].[PasswordHash], [u].[Phone]
FROM [Users] AS [u]
WHERE [u].[Id] = @__request_MasterId_0
2024-06-18 11:57:46.940 +03:00 [INF] User profile is available. Using 'C:\Users\vitia\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-06-18 11:57:47.212 +03:00 [INF] Now listening on: https://localhost:7014
2024-06-18 11:57:47.212 +03:00 [INF] Now listening on: http://localhost:5281
2024-06-18 11:57:47.214 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2024-06-18 11:57:47.214 +03:00 [INF] Hosting environment: Development
2024-06-18 11:57:47.214 +03:00 [INF] Content root path: D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequestMicroservice\RepairRequest.Api
2024-06-18 11:57:47.627 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/swagger/index.html - null null
2024-06-18 11:57:47.820 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/swagger/index.html - 200 null text/html;charset=utf-8 194.9817ms
2024-06-18 11:57:47.829 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/_framework/aspnetcore-browser-refresh.js - null null
2024-06-18 11:57:47.835 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/_framework/aspnetcore-browser-refresh.js - 200 13770 application/javascript; charset=utf-8 5.8293ms
2024-06-18 11:57:47.843 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/_vs/browserLink - null null
2024-06-18 11:57:47.876 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/_vs/browserLink - 200 null text/javascript; charset=UTF-8 33.429ms
2024-06-18 11:57:47.963 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/swagger/v1/swagger.json - null null
2024-06-18 11:57:48.056 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 93.2616ms
2024-06-18 12:03:00.912 +03:00 [INF] User profile is available. Using 'C:\Users\vitia\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-06-18 12:03:01.170 +03:00 [INF] Now listening on: https://localhost:7014
2024-06-18 12:03:01.170 +03:00 [INF] Now listening on: http://localhost:5281
2024-06-18 12:03:01.171 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2024-06-18 12:03:01.171 +03:00 [INF] Hosting environment: Development
2024-06-18 12:03:01.171 +03:00 [INF] Content root path: D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequestMicroservice\RepairRequest.Api
2024-06-18 12:03:01.867 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/swagger/index.html - null null
2024-06-18 12:03:02.052 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/swagger/index.html - 200 null text/html;charset=utf-8 189.6596ms
2024-06-18 12:03:02.061 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/_framework/aspnetcore-browser-refresh.js - null null
2024-06-18 12:03:02.066 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/_framework/aspnetcore-browser-refresh.js - 200 13770 application/javascript; charset=utf-8 5.0094ms
2024-06-18 12:03:02.075 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/_vs/browserLink - null null
2024-06-18 12:03:02.144 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/_vs/browserLink - 200 null text/javascript; charset=UTF-8 68.7353ms
2024-06-18 12:03:02.216 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/swagger/v1/swagger.json - null null
2024-06-18 12:03:02.354 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 138.4809ms
2024-06-18 12:03:22.206 +03:00 [INF] Request starting HTTP/2 PUT https://localhost:7014/repair-requests/accept-request - application/json 30
2024-06-18 12:03:22.328 +03:00 [INF] Executing endpoint 'RepairRequest.Api.Controllers.RepairRequestController.AcceptRequest (RepairRequest.Api)'
2024-06-18 12:03:22.347 +03:00 [INF] Route matched with {action = "AcceptRequest", controller = "RepairRequest"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AcceptRequest(RepairRequest.Application.Requests.Comands.AcceptRequest.AcceptRequestComand, MediatR.IMediator, System.Threading.CancellationToken) on controller RepairRequest.Api.Controllers.RepairRequestController (RepairRequest.Api).
2024-06-18 12:03:25.810 +03:00 [INF] Executed DbCommand (55ms) [Parameters=[@__request_MasterId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Login], [u].[PasswordHash], [u].[Phone]
FROM [Users] AS [u]
WHERE [u].[Id] = @__request_MasterId_0
2024-06-18 12:03:28.868 +03:00 [INF] Executed DbCommand (24ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[Name]
FROM [AppUserRole] AS [a]
WHERE [a].[Name] = N'Master'
2024-06-18 12:03:33.066 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__master_Id_0='?' (DbType = Int32), @__masterRole_Id_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[RoleId], [a].[UserId]
FROM [AppUserAppRole] AS [a]
WHERE [a].[UserId] = @__master_Id_0 AND [a].[RoleId] = @__masterRole_Id_1
2024-06-18 12:03:45.885 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [r].[Id], [r].[LeadTime], [r].[MasterId], [r].[RequestStatusId], [r].[ServiceCenterId], [r].[StatusId], [r].[UserId]
FROM [Requests] AS [r]
WHERE [r].[Id] = @__request_Id_0
2024-06-18 12:03:45.906 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [r].[Id], [r].[StatusName]
FROM [RequestStatuses] AS [r]
WHERE [r].[StatusName] = N'Accepted'
2024-06-18 12:05:57.153 +03:00 [INF] User profile is available. Using 'C:\Users\vitia\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-06-18 12:05:57.432 +03:00 [INF] Now listening on: https://localhost:7014
2024-06-18 12:05:57.433 +03:00 [INF] Now listening on: http://localhost:5281
2024-06-18 12:05:57.434 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2024-06-18 12:05:57.434 +03:00 [INF] Hosting environment: Development
2024-06-18 12:05:57.434 +03:00 [INF] Content root path: D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequestMicroservice\RepairRequest.Api
2024-06-18 12:05:57.798 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/swagger/index.html - null null
2024-06-18 12:05:58.011 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/swagger/index.html - 200 null text/html;charset=utf-8 217.1109ms
2024-06-18 12:05:58.022 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/_framework/aspnetcore-browser-refresh.js - null null
2024-06-18 12:05:58.029 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/_framework/aspnetcore-browser-refresh.js - 200 13770 application/javascript; charset=utf-8 6.3393ms
2024-06-18 12:05:58.037 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/_vs/browserLink - null null
2024-06-18 12:05:58.086 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/_vs/browserLink - 200 null text/javascript; charset=UTF-8 49.1351ms
2024-06-18 12:05:58.187 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/swagger/v1/swagger.json - null null
2024-06-18 12:05:58.298 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 111.7206ms
2024-06-18 12:06:15.501 +03:00 [INF] Request starting HTTP/2 PUT https://localhost:7014/repair-requests/accept-request - application/json 30
2024-06-18 12:06:15.620 +03:00 [INF] Executing endpoint 'RepairRequest.Api.Controllers.RepairRequestController.AcceptRequest (RepairRequest.Api)'
2024-06-18 12:06:15.639 +03:00 [INF] Route matched with {action = "AcceptRequest", controller = "RepairRequest"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AcceptRequest(RepairRequest.Application.Requests.Comands.AcceptRequest.AcceptRequestComand, MediatR.IMediator, System.Threading.CancellationToken) on controller RepairRequest.Api.Controllers.RepairRequestController (RepairRequest.Api).
2024-06-18 12:06:20.284 +03:00 [INF] Executed DbCommand (59ms) [Parameters=[@__request_MasterId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Login], [u].[PasswordHash], [u].[Phone]
FROM [Users] AS [u]
WHERE [u].[Id] = @__request_MasterId_0
2024-06-18 12:06:22.536 +03:00 [INF] Executed DbCommand (23ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[Name]
FROM [AppUserRole] AS [a]
WHERE [a].[Name] = N'Master'
2024-06-18 12:06:23.378 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__master_Id_0='?' (DbType = Int32), @__masterRole_Id_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[RoleId], [a].[UserId]
FROM [AppUserAppRole] AS [a]
WHERE [a].[UserId] = @__master_Id_0 AND [a].[RoleId] = @__masterRole_Id_1
2024-06-18 12:06:30.825 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__request_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [r].[Id], [r].[LeadTime], [r].[MasterId], [r].[RequestStatusId], [r].[ServiceCenterId], [r].[StatusId], [r].[UserId]
FROM [Requests] AS [r]
WHERE [r].[Id] = @__request_Id_0
2024-06-18 12:06:34.544 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [r].[Id], [r].[StatusName]
FROM [RequestStatuses] AS [r]
WHERE [r].[StatusName] = N'Accepted'
2024-06-18 12:06:36.542 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@p6='?' (DbType = Int32), @p0='?' (DbType = DateTime2), @p1='?' (DbType = Int32), @p2='?' (DbType = Int32), @p3='?' (DbType = Int32), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Requests] SET [LeadTime] = @p0, [MasterId] = @p1, [RequestStatusId] = @p2, [ServiceCenterId] = @p3, [StatusId] = @p4, [UserId] = @p5
OUTPUT 1
WHERE [Id] = @p6;
2024-06-18 12:06:44.832 +03:00 [INF] Executing OkObjectResult, writing value of type 'RepairRequest.Application.dto.GetRequestsDTO'.
2024-06-18 12:06:44.848 +03:00 [INF] Executed action RepairRequest.Api.Controllers.RepairRequestController.AcceptRequest (RepairRequest.Api) in 29205.9037ms
2024-06-18 12:06:44.849 +03:00 [INF] Executed endpoint 'RepairRequest.Api.Controllers.RepairRequestController.AcceptRequest (RepairRequest.Api)'
2024-06-18 12:06:44.856 +03:00 [INF] Request finished HTTP/2 PUT https://localhost:7014/repair-requests/accept-request - 200 null application/json; charset=utf-8 29354.8813ms
2024-06-18 12:07:12.992 +03:00 [INF] Request starting HTTP/2 PUT https://localhost:7014/repair-requests/complet - application/json 13
2024-06-18 12:07:12.996 +03:00 [INF] Executing endpoint 'RepairRequest.Api.Controllers.RepairRequestController.SetCompleated (RepairRequest.Api)'
2024-06-18 12:07:13.000 +03:00 [INF] Route matched with {action = "SetCompleated", controller = "RepairRequest"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SetCompleated(RepairRequest.Application.Requests.Comands.CancelRequest.CancelRequestComand, MediatR.IMediator, System.Threading.CancellationToken) on controller RepairRequest.Api.Controllers.RepairRequestController (RepairRequest.Api).
2024-06-18 12:07:13.029 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__currentUserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Login], [u].[PasswordHash], [u].[Phone]
FROM [Users] AS [u]
WHERE [u].[Id] = @__currentUserId_0
2024-06-18 12:07:13.035 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [r].[Id], [r].[LeadTime], [r].[MasterId], [r].[RequestStatusId], [r].[ServiceCenterId], [r].[StatusId], [r].[UserId]
FROM [Requests] AS [r]
WHERE [r].[Id] = @__request_Id_0
2024-06-18 12:07:13.251 +03:00 [INF] Executed action RepairRequest.Api.Controllers.RepairRequestController.SetCompleated (RepairRequest.Api) in 249.9426ms
2024-06-18 12:07:13.251 +03:00 [INF] Executed endpoint 'RepairRequest.Api.Controllers.RepairRequestController.SetCompleated (RepairRequest.Api)'
2024-06-18 12:07:13.255 +03:00 [ERR] An unhandled exception has occurred while executing the request.
RepairRequest.Service.Exeptions.ForbidenExeption: No permision to delete this request
   at RepairRequest.Application.Requests.Comands.CancelRequest.CancelRequestComandHandler.Handle(CancelRequestComand request, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequest.Application\Requests\Comands\CancelRequest\CancelRequestComandHandler.cs:line 68
   at RepairRequest.Application.Behaviors.ContextTransactionBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequest.Application\Behaviors\ContextTransactionBehavior.cs:line 20
   at RepairRequest.Application.Behaviors.ContextTransactionBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequest.Application\Behaviors\ContextTransactionBehavior.cs:line 27
   at RepairRequest.Application.Behaviors.ContextTransactionBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequest.Application\Behaviors\ContextTransactionBehavior.cs:line 29
   at RepairRequest.Application.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequest.Application\Behaviors\ValidationBehavior.cs:line 24
   at RepairRequest.Api.Controllers.RepairRequestController.SetCompleated(CancelRequestComand command, IMediator mediator, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequestMicroservice\RepairRequest.Api\Controllers\RepairRequestController.cs:line 83
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2024-06-18 12:07:13.301 +03:00 [INF] Request finished HTTP/2 PUT https://localhost:7014/repair-requests/complet - 500 null text/plain; charset=utf-8 309.2654ms
2024-06-18 12:07:52.440 +03:00 [INF] Request starting HTTP/2 PUT https://localhost:7014/repair-requests/complet - application/json 13
2024-06-18 12:07:52.448 +03:00 [INF] Executing endpoint 'RepairRequest.Api.Controllers.RepairRequestController.SetCompleated (RepairRequest.Api)'
2024-06-18 12:07:52.449 +03:00 [INF] Route matched with {action = "SetCompleated", controller = "RepairRequest"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SetCompleated(RepairRequest.Application.Requests.Comands.CancelRequest.CancelRequestComand, MediatR.IMediator, System.Threading.CancellationToken) on controller RepairRequest.Api.Controllers.RepairRequestController (RepairRequest.Api).
2024-06-18 12:07:52.516 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__currentUserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Login], [u].[PasswordHash], [u].[Phone]
FROM [Users] AS [u]
WHERE [u].[Id] = @__currentUserId_0
2024-06-18 12:07:52.518 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [r].[Id], [r].[LeadTime], [r].[MasterId], [r].[RequestStatusId], [r].[ServiceCenterId], [r].[StatusId], [r].[UserId]
FROM [Requests] AS [r]
WHERE [r].[Id] = @__request_Id_0
2024-06-18 12:07:52.522 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [r].[Id], [r].[StatusName]
FROM [RequestStatuses] AS [r]
WHERE [r].[StatusName] = N'Canceled by Master'
2024-06-18 12:07:52.528 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@p6='?' (DbType = Int32), @p0='?' (DbType = DateTime2), @p1='?' (DbType = Int32), @p2='?' (DbType = Int32), @p3='?' (DbType = Int32), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Requests] SET [LeadTime] = @p0, [MasterId] = @p1, [RequestStatusId] = @p2, [ServiceCenterId] = @p3, [StatusId] = @p4, [UserId] = @p5
OUTPUT 1
WHERE [Id] = @p6;
2024-06-18 12:07:52.723 +03:00 [ERR] An error occurred using a transaction.
2024-06-18 12:07:52.914 +03:00 [INF] Executed action RepairRequest.Api.Controllers.RepairRequestController.SetCompleated (RepairRequest.Api) in 465.0852ms
2024-06-18 12:07:52.915 +03:00 [INF] Executed endpoint 'RepairRequest.Api.Controllers.RepairRequestController.SetCompleated (RepairRequest.Api)'
2024-06-18 12:07:52.916 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Commit()
   at Microsoft.Data.SqlClient.SqlTransaction.Commit()
   at System.Data.Common.DbTransaction.CommitAsync(CancellationToken cancellationToken)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.CommitAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.CommitAsync(CancellationToken cancellationToken)
   at RepairRequest.Percistance.ContextTransaction.CommitAsync(CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequestMicroservice\RepairRequest.Percistance\ContextTransaction.cs:line 16
   at RepairRequest.Application.Behaviors.ContextTransactionBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequest.Application\Behaviors\ContextTransactionBehavior.cs:line 21
   at RepairRequest.Application.Behaviors.ContextTransactionBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequest.Application\Behaviors\ContextTransactionBehavior.cs:line 27
   at RepairRequest.Application.Behaviors.ContextTransactionBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequest.Application\Behaviors\ContextTransactionBehavior.cs:line 29
   at RepairRequest.Application.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequest.Application\Behaviors\ValidationBehavior.cs:line 24
   at RepairRequest.Api.Controllers.RepairRequestController.SetCompleated(CancelRequestComand command, IMediator mediator, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequestMicroservice\RepairRequest.Api\Controllers\RepairRequestController.cs:line 83
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2024-06-18 12:07:52.930 +03:00 [INF] Request finished HTTP/2 PUT https://localhost:7014/repair-requests/complet - 500 null text/plain; charset=utf-8 487.5555ms
2024-06-18 12:08:24.738 +03:00 [INF] User profile is available. Using 'C:\Users\vitia\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-06-18 12:08:25.011 +03:00 [INF] Now listening on: https://localhost:7014
2024-06-18 12:08:25.011 +03:00 [INF] Now listening on: http://localhost:5281
2024-06-18 12:08:25.012 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2024-06-18 12:08:25.013 +03:00 [INF] Hosting environment: Development
2024-06-18 12:08:25.013 +03:00 [INF] Content root path: D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequestMicroservice\RepairRequest.Api
2024-06-18 12:08:25.559 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/swagger/index.html - null null
2024-06-18 12:08:25.765 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/swagger/index.html - 200 null text/html;charset=utf-8 208.4817ms
2024-06-18 12:08:25.791 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/_framework/aspnetcore-browser-refresh.js - null null
2024-06-18 12:08:25.791 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/_vs/browserLink - null null
2024-06-18 12:08:25.796 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/_framework/aspnetcore-browser-refresh.js - 200 13770 application/javascript; charset=utf-8 4.6117ms
2024-06-18 12:08:25.827 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/_vs/browserLink - 200 null text/javascript; charset=UTF-8 35.7415ms
2024-06-18 12:08:25.907 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/swagger/v1/swagger.json - null null
2024-06-18 12:08:26.005 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 98.4975ms
2024-06-18 12:08:38.169 +03:00 [INF] Request starting HTTP/2 PUT https://localhost:7014/repair-requests/complet - application/json 13
2024-06-18 12:08:38.287 +03:00 [INF] Executing endpoint 'RepairRequest.Api.Controllers.RepairRequestController.SetCompleated (RepairRequest.Api)'
2024-06-18 12:08:38.307 +03:00 [INF] Route matched with {action = "SetCompleated", controller = "RepairRequest"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SetCompleated(RepairRequest.Application.Requests.Comands.CancelRequest.CancelRequestComand, MediatR.IMediator, System.Threading.CancellationToken) on controller RepairRequest.Api.Controllers.RepairRequestController (RepairRequest.Api).
2024-06-18 12:08:46.035 +03:00 [INF] Executed DbCommand (60ms) [Parameters=[@__currentUserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Login], [u].[PasswordHash], [u].[Phone]
FROM [Users] AS [u]
WHERE [u].[Id] = @__currentUserId_0
2024-06-18 12:08:52.677 +03:00 [INF] Executed DbCommand (67ms) [Parameters=[@__request_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [r].[Id], [r].[LeadTime], [r].[MasterId], [r].[RequestStatusId], [r].[ServiceCenterId], [r].[StatusId], [r].[UserId]
FROM [Requests] AS [r]
WHERE [r].[Id] = @__request_Id_0
2024-06-18 12:09:07.792 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [r].[Id], [r].[StatusName]
FROM [RequestStatuses] AS [r]
WHERE [r].[StatusName] = N'Canceled by Master'
2024-06-18 12:09:29.162 +03:00 [INF] User profile is available. Using 'C:\Users\vitia\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-06-18 12:09:29.462 +03:00 [INF] Now listening on: https://localhost:7014
2024-06-18 12:09:29.463 +03:00 [INF] Now listening on: http://localhost:5281
2024-06-18 12:09:29.464 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2024-06-18 12:09:29.465 +03:00 [INF] Hosting environment: Development
2024-06-18 12:09:29.465 +03:00 [INF] Content root path: D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequestMicroservice\RepairRequest.Api
2024-06-18 12:09:30.117 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/swagger/index.html - null null
2024-06-18 12:09:30.307 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/swagger/index.html - 200 null text/html;charset=utf-8 193.8328ms
2024-06-18 12:09:30.315 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/_framework/aspnetcore-browser-refresh.js - null null
2024-06-18 12:09:30.321 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/_framework/aspnetcore-browser-refresh.js - 200 13770 application/javascript; charset=utf-8 6.355ms
2024-06-18 12:09:30.328 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/_vs/browserLink - null null
2024-06-18 12:09:30.362 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/_vs/browserLink - 200 null text/javascript; charset=UTF-8 34.1776ms
2024-06-18 12:09:30.453 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/swagger/v1/swagger.json - null null
2024-06-18 12:09:30.563 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 109.8514ms
2024-06-18 12:09:44.370 +03:00 [INF] Request starting HTTP/2 PUT https://localhost:7014/repair-requests/complet - application/json 13
2024-06-18 12:09:44.489 +03:00 [INF] Executing endpoint 'RepairRequest.Api.Controllers.RepairRequestController.SetCompleated (RepairRequest.Api)'
2024-06-18 12:09:44.509 +03:00 [INF] Route matched with {action = "SetCompleated", controller = "RepairRequest"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SetCompleated(RepairRequest.Application.Requests.Comands.CancelRequest.CancelRequestComand, MediatR.IMediator, System.Threading.CancellationToken) on controller RepairRequest.Api.Controllers.RepairRequestController (RepairRequest.Api).
2024-06-18 12:09:48.150 +03:00 [INF] Executed DbCommand (41ms) [Parameters=[@__currentUserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Login], [u].[PasswordHash], [u].[Phone]
FROM [Users] AS [u]
WHERE [u].[Id] = @__currentUserId_0
2024-06-18 12:09:48.223 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__request_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [r].[Id], [r].[LeadTime], [r].[MasterId], [r].[RequestStatusId], [r].[ServiceCenterId], [r].[StatusId], [r].[UserId]
FROM [Requests] AS [r]
WHERE [r].[Id] = @__request_Id_0
2024-06-18 12:09:48.252 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [r].[Id], [r].[StatusName]
FROM [RequestStatuses] AS [r]
WHERE [r].[StatusName] = N'Canceled by Master'
2024-06-18 12:09:48.352 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@p6='?' (DbType = Int32), @p0='?' (DbType = DateTime2), @p1='?' (DbType = Int32), @p2='?' (DbType = Int32), @p3='?' (DbType = Int32), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Requests] SET [LeadTime] = @p0, [MasterId] = @p1, [RequestStatusId] = @p2, [ServiceCenterId] = @p3, [StatusId] = @p4, [UserId] = @p5
OUTPUT 1
WHERE [Id] = @p6;
2024-06-18 12:09:48.383 +03:00 [INF] Executing OkObjectResult, writing value of type 'RepairRequest.Application.dto.GetRequestsDTO'.
2024-06-18 12:09:48.396 +03:00 [INF] Executed action RepairRequest.Api.Controllers.RepairRequestController.SetCompleated (RepairRequest.Api) in 3883.7967ms
2024-06-18 12:09:48.397 +03:00 [INF] Executed endpoint 'RepairRequest.Api.Controllers.RepairRequestController.SetCompleated (RepairRequest.Api)'
2024-06-18 12:09:48.402 +03:00 [INF] Request finished HTTP/2 PUT https://localhost:7014/repair-requests/complet - 200 null application/json; charset=utf-8 4032.7033ms
2024-06-18 12:09:58.119 +03:00 [INF] User profile is available. Using 'C:\Users\vitia\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-06-18 12:09:58.434 +03:00 [INF] Now listening on: https://localhost:7014
2024-06-18 12:09:58.435 +03:00 [INF] Now listening on: http://localhost:5281
2024-06-18 12:09:58.436 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2024-06-18 12:09:58.436 +03:00 [INF] Hosting environment: Development
2024-06-18 12:09:58.437 +03:00 [INF] Content root path: D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequestMicroservice\RepairRequest.Api
2024-06-18 12:09:59.115 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/swagger/index.html - null null
2024-06-18 12:09:59.307 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/swagger/index.html - 200 null text/html;charset=utf-8 198.2352ms
2024-06-18 12:09:59.314 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/_framework/aspnetcore-browser-refresh.js - null null
2024-06-18 12:09:59.318 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/_framework/aspnetcore-browser-refresh.js - 200 13770 application/javascript; charset=utf-8 4.4749ms
2024-06-18 12:09:59.326 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/_vs/browserLink - null null
2024-06-18 12:09:59.362 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/_vs/browserLink - 200 null text/javascript; charset=UTF-8 36.6435ms
2024-06-18 12:09:59.451 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/swagger/v1/swagger.json - null null
2024-06-18 12:09:59.560 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 109.6684ms
2024-06-18 12:10:12.747 +03:00 [INF] Request starting HTTP/2 PUT https://localhost:7014/repair-requests/cancel-request - application/json 13
2024-06-18 12:10:12.873 +03:00 [INF] Executing endpoint 'RepairRequest.Api.Controllers.RepairRequestController.CancelRequest (RepairRequest.Api)'
2024-06-18 12:10:12.892 +03:00 [INF] Route matched with {action = "CancelRequest", controller = "RepairRequest"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CancelRequest(RepairRequest.Application.Requests.Comands.CancelRequest.CancelRequestComand, MediatR.IMediator, System.Threading.CancellationToken) on controller RepairRequest.Api.Controllers.RepairRequestController (RepairRequest.Api).
2024-06-18 12:10:14.167 +03:00 [INF] Executed DbCommand (42ms) [Parameters=[@__currentUserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Login], [u].[PasswordHash], [u].[Phone]
FROM [Users] AS [u]
WHERE [u].[Id] = @__currentUserId_0
2024-06-18 12:10:14.240 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__request_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [r].[Id], [r].[LeadTime], [r].[MasterId], [r].[RequestStatusId], [r].[ServiceCenterId], [r].[StatusId], [r].[UserId]
FROM [Requests] AS [r]
WHERE [r].[Id] = @__request_Id_0
2024-06-18 12:10:14.272 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [r].[Id], [r].[StatusName]
FROM [RequestStatuses] AS [r]
WHERE [r].[StatusName] = N'Canceled by Master'
2024-06-18 12:10:14.378 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p6='?' (DbType = Int32), @p0='?' (DbType = DateTime2), @p1='?' (DbType = Int32), @p2='?' (DbType = Int32), @p3='?' (DbType = Int32), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Requests] SET [LeadTime] = @p0, [MasterId] = @p1, [RequestStatusId] = @p2, [ServiceCenterId] = @p3, [StatusId] = @p4, [UserId] = @p5
OUTPUT 1
WHERE [Id] = @p6;
2024-06-18 12:10:14.412 +03:00 [INF] Executing OkObjectResult, writing value of type 'RepairRequest.Application.dto.GetRequestsDTO'.
2024-06-18 12:10:14.427 +03:00 [INF] Executed action RepairRequest.Api.Controllers.RepairRequestController.CancelRequest (RepairRequest.Api) in 1531.7239ms
2024-06-18 12:10:14.428 +03:00 [INF] Executed endpoint 'RepairRequest.Api.Controllers.RepairRequestController.CancelRequest (RepairRequest.Api)'
2024-06-18 12:10:14.435 +03:00 [INF] Request finished HTTP/2 PUT https://localhost:7014/repair-requests/cancel-request - 200 null application/json; charset=utf-8 1688.1437ms
2024-06-18 12:10:36.442 +03:00 [INF] Request starting HTTP/2 PUT https://localhost:7014/repair-requests/complet - application/json 13
2024-06-18 12:10:36.450 +03:00 [INF] Executing endpoint 'RepairRequest.Api.Controllers.RepairRequestController.SetCompleated (RepairRequest.Api)'
2024-06-18 12:10:36.456 +03:00 [INF] Route matched with {action = "SetCompleated", controller = "RepairRequest"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SetCompleated(RepairRequest.Application.Requests.Comands.CancelRequest.CancelRequestComand, MediatR.IMediator, System.Threading.CancellationToken) on controller RepairRequest.Api.Controllers.RepairRequestController (RepairRequest.Api).
2024-06-18 12:10:36.485 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__currentUserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Login], [u].[PasswordHash], [u].[Phone]
FROM [Users] AS [u]
WHERE [u].[Id] = @__currentUserId_0
2024-06-18 12:10:36.488 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [r].[Id], [r].[LeadTime], [r].[MasterId], [r].[RequestStatusId], [r].[ServiceCenterId], [r].[StatusId], [r].[UserId]
FROM [Requests] AS [r]
WHERE [r].[Id] = @__request_Id_0
2024-06-18 12:10:36.490 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [r].[Id], [r].[StatusName]
FROM [RequestStatuses] AS [r]
WHERE [r].[StatusName] = N'Canceled by Master'
2024-06-18 12:10:36.494 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@p6='?' (DbType = Int32), @p0='?' (DbType = DateTime2), @p1='?' (DbType = Int32), @p2='?' (DbType = Int32), @p3='?' (DbType = Int32), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Requests] SET [LeadTime] = @p0, [MasterId] = @p1, [RequestStatusId] = @p2, [ServiceCenterId] = @p3, [StatusId] = @p4, [UserId] = @p5
OUTPUT 1
WHERE [Id] = @p6;
2024-06-18 12:10:36.497 +03:00 [INF] Executing OkObjectResult, writing value of type 'RepairRequest.Application.dto.GetRequestsDTO'.
2024-06-18 12:10:36.497 +03:00 [INF] Executed action RepairRequest.Api.Controllers.RepairRequestController.SetCompleated (RepairRequest.Api) in 41.1398ms
2024-06-18 12:10:36.497 +03:00 [INF] Executed endpoint 'RepairRequest.Api.Controllers.RepairRequestController.SetCompleated (RepairRequest.Api)'
2024-06-18 12:10:36.497 +03:00 [INF] Request finished HTTP/2 PUT https://localhost:7014/repair-requests/complet - 200 null application/json; charset=utf-8 55.3371ms
2024-06-18 12:11:17.258 +03:00 [INF] User profile is available. Using 'C:\Users\vitia\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-06-18 12:11:17.550 +03:00 [INF] Now listening on: https://localhost:7014
2024-06-18 12:11:17.550 +03:00 [INF] Now listening on: http://localhost:5281
2024-06-18 12:11:17.552 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2024-06-18 12:11:17.552 +03:00 [INF] Hosting environment: Development
2024-06-18 12:11:17.552 +03:00 [INF] Content root path: D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequestMicroservice\RepairRequest.Api
2024-06-18 12:11:18.256 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/swagger/index.html - null null
2024-06-18 12:11:18.522 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/swagger/index.html - 200 null text/html;charset=utf-8 272.2452ms
2024-06-18 12:11:18.531 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/_framework/aspnetcore-browser-refresh.js - null null
2024-06-18 12:11:18.540 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/_framework/aspnetcore-browser-refresh.js - 200 13770 application/javascript; charset=utf-8 8.7738ms
2024-06-18 12:11:18.546 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/_vs/browserLink - null null
2024-06-18 12:11:18.604 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/_vs/browserLink - 200 null text/javascript; charset=UTF-8 57.4705ms
2024-06-18 12:11:18.706 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/swagger/v1/swagger.json - null null
2024-06-18 12:11:18.817 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 111.7698ms
2024-06-18 12:11:34.909 +03:00 [INF] Request starting HTTP/2 PUT https://localhost:7014/repair-requests/done - application/json 13
2024-06-18 12:11:35.037 +03:00 [INF] Executing endpoint 'RepairRequest.Api.Controllers.RepairRequestController.SetDone (RepairRequest.Api)'
2024-06-18 12:11:35.058 +03:00 [INF] Route matched with {action = "SetDone", controller = "RepairRequest"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SetDone(RepairRequest.Application.Requests.Comands.CancelRequest.CancelRequestComand, MediatR.IMediator, System.Threading.CancellationToken) on controller RepairRequest.Api.Controllers.RepairRequestController (RepairRequest.Api).
2024-06-18 12:11:36.383 +03:00 [INF] Executed DbCommand (39ms) [Parameters=[@__currentUserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Login], [u].[PasswordHash], [u].[Phone]
FROM [Users] AS [u]
WHERE [u].[Id] = @__currentUserId_0
2024-06-18 12:11:36.461 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__request_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [r].[Id], [r].[LeadTime], [r].[MasterId], [r].[RequestStatusId], [r].[ServiceCenterId], [r].[StatusId], [r].[UserId]
FROM [Requests] AS [r]
WHERE [r].[Id] = @__request_Id_0
2024-06-18 12:11:36.489 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [r].[Id], [r].[StatusName]
FROM [RequestStatuses] AS [r]
WHERE [r].[StatusName] = N'Canceled by Master'
2024-06-18 12:11:36.587 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@p6='?' (DbType = Int32), @p0='?' (DbType = DateTime2), @p1='?' (DbType = Int32), @p2='?' (DbType = Int32), @p3='?' (DbType = Int32), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Requests] SET [LeadTime] = @p0, [MasterId] = @p1, [RequestStatusId] = @p2, [ServiceCenterId] = @p3, [StatusId] = @p4, [UserId] = @p5
OUTPUT 1
WHERE [Id] = @p6;
2024-06-18 12:11:36.619 +03:00 [INF] Executing OkObjectResult, writing value of type 'RepairRequest.Application.dto.GetRequestsDTO'.
2024-06-18 12:11:36.633 +03:00 [INF] Executed action RepairRequest.Api.Controllers.RepairRequestController.SetDone (RepairRequest.Api) in 1572.0526ms
2024-06-18 12:11:36.633 +03:00 [INF] Executed endpoint 'RepairRequest.Api.Controllers.RepairRequestController.SetDone (RepairRequest.Api)'
2024-06-18 12:11:36.640 +03:00 [INF] Request finished HTTP/2 PUT https://localhost:7014/repair-requests/done - 200 null application/json; charset=utf-8 1731.2181ms
2024-06-18 12:11:55.597 +03:00 [INF] Request starting HTTP/2 PUT https://localhost:7014/repair-requests/done - application/json 13
2024-06-18 12:11:55.601 +03:00 [INF] Executing endpoint 'RepairRequest.Api.Controllers.RepairRequestController.SetDone (RepairRequest.Api)'
2024-06-18 12:11:55.602 +03:00 [INF] Route matched with {action = "SetDone", controller = "RepairRequest"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SetDone(RepairRequest.Application.Requests.Comands.CancelRequest.CancelRequestComand, MediatR.IMediator, System.Threading.CancellationToken) on controller RepairRequest.Api.Controllers.RepairRequestController (RepairRequest.Api).
2024-06-18 12:11:55.626 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__currentUserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Login], [u].[PasswordHash], [u].[Phone]
FROM [Users] AS [u]
WHERE [u].[Id] = @__currentUserId_0
2024-06-18 12:11:55.628 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [r].[Id], [r].[LeadTime], [r].[MasterId], [r].[RequestStatusId], [r].[ServiceCenterId], [r].[StatusId], [r].[UserId]
FROM [Requests] AS [r]
WHERE [r].[Id] = @__request_Id_0
2024-06-18 12:11:55.630 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [r].[Id], [r].[StatusName]
FROM [RequestStatuses] AS [r]
WHERE [r].[StatusName] = N'Canceled by Master'
2024-06-18 12:11:55.634 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@p6='?' (DbType = Int32), @p0='?' (DbType = DateTime2), @p1='?' (DbType = Int32), @p2='?' (DbType = Int32), @p3='?' (DbType = Int32), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Requests] SET [LeadTime] = @p0, [MasterId] = @p1, [RequestStatusId] = @p2, [ServiceCenterId] = @p3, [StatusId] = @p4, [UserId] = @p5
OUTPUT 1
WHERE [Id] = @p6;
2024-06-18 12:11:55.639 +03:00 [INF] Executing OkObjectResult, writing value of type 'RepairRequest.Application.dto.GetRequestsDTO'.
2024-06-18 12:11:55.640 +03:00 [INF] Executed action RepairRequest.Api.Controllers.RepairRequestController.SetDone (RepairRequest.Api) in 37.81ms
2024-06-18 12:11:55.640 +03:00 [INF] Executed endpoint 'RepairRequest.Api.Controllers.RepairRequestController.SetDone (RepairRequest.Api)'
2024-06-18 12:11:55.640 +03:00 [INF] Request finished HTTP/2 PUT https://localhost:7014/repair-requests/done - 200 null application/json; charset=utf-8 43.2552ms
2024-06-18 12:12:51.693 +03:00 [INF] User profile is available. Using 'C:\Users\vitia\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-06-18 12:12:51.949 +03:00 [INF] Now listening on: https://localhost:7014
2024-06-18 12:12:51.949 +03:00 [INF] Now listening on: http://localhost:5281
2024-06-18 12:12:51.950 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2024-06-18 12:12:51.950 +03:00 [INF] Hosting environment: Development
2024-06-18 12:12:51.950 +03:00 [INF] Content root path: D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequestMicroservice\RepairRequest.Api
2024-06-18 12:12:52.620 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/swagger/index.html - null null
2024-06-18 12:12:52.825 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/swagger/index.html - 200 null text/html;charset=utf-8 207.5254ms
2024-06-18 12:12:52.835 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/_framework/aspnetcore-browser-refresh.js - null null
2024-06-18 12:12:52.839 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/_framework/aspnetcore-browser-refresh.js - 200 13770 application/javascript; charset=utf-8 4.3278ms
2024-06-18 12:12:52.847 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/_vs/browserLink - null null
2024-06-18 12:12:52.885 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/_vs/browserLink - 200 null text/javascript; charset=UTF-8 38.0301ms
2024-06-18 12:12:52.975 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/swagger/v1/swagger.json - null null
2024-06-18 12:12:53.093 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 118.3263ms
2024-06-18 12:15:07.378 +03:00 [INF] Request starting HTTP/2 PUT https://localhost:7014/repair-requests/done - application/json 13
2024-06-18 12:15:07.506 +03:00 [INF] Executing endpoint 'RepairRequest.Api.Controllers.RepairRequestController.SetDone (RepairRequest.Api)'
2024-06-18 12:15:07.525 +03:00 [INF] Route matched with {action = "SetDone", controller = "RepairRequest"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SetDone(RepairRequest.Application.Requests.Comands.SetDoneStatus.SetDoneStatusComand, MediatR.IMediator, System.Threading.CancellationToken) on controller RepairRequest.Api.Controllers.RepairRequestController (RepairRequest.Api).
2024-06-18 12:15:14.093 +03:00 [INF] Executed DbCommand (42ms) [Parameters=[@__currentUserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Login], [u].[PasswordHash], [u].[Phone]
FROM [Users] AS [u]
WHERE [u].[Id] = @__currentUserId_0
2024-06-18 12:15:14.166 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__request_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [r].[Id], [r].[LeadTime], [r].[MasterId], [r].[RequestStatusId], [r].[ServiceCenterId], [r].[StatusId], [r].[UserId]
FROM [Requests] AS [r]
WHERE [r].[Id] = @__request_Id_0
2024-06-18 12:15:14.194 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [r].[Id], [r].[StatusName]
FROM [RequestStatuses] AS [r]
WHERE [r].[StatusName] = N'Done'
2024-06-18 12:15:14.294 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@p6='?' (DbType = Int32), @p0='?' (DbType = DateTime2), @p1='?' (DbType = Int32), @p2='?' (DbType = Int32), @p3='?' (DbType = Int32), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Requests] SET [LeadTime] = @p0, [MasterId] = @p1, [RequestStatusId] = @p2, [ServiceCenterId] = @p3, [StatusId] = @p4, [UserId] = @p5
OUTPUT 1
WHERE [Id] = @p6;
2024-06-18 12:15:14.316 +03:00 [INF] Executing OkObjectResult, writing value of type 'RepairRequest.Application.dto.GetRequestsDTO'.
2024-06-18 12:15:14.331 +03:00 [INF] Executed action RepairRequest.Api.Controllers.RepairRequestController.SetDone (RepairRequest.Api) in 6802.9565ms
2024-06-18 12:15:14.332 +03:00 [INF] Executed endpoint 'RepairRequest.Api.Controllers.RepairRequestController.SetDone (RepairRequest.Api)'
2024-06-18 12:15:14.340 +03:00 [INF] Request finished HTTP/2 PUT https://localhost:7014/repair-requests/done - 200 null application/json; charset=utf-8 6962.6603ms
2024-06-18 12:15:25.896 +03:00 [INF] Request starting HTTP/2 PUT https://localhost:7014/repair-requests/complet - application/json 13
2024-06-18 12:15:25.901 +03:00 [INF] Executing endpoint 'RepairRequest.Api.Controllers.RepairRequestController.SetCompleated (RepairRequest.Api)'
2024-06-18 12:15:25.908 +03:00 [INF] Route matched with {action = "SetCompleated", controller = "RepairRequest"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SetCompleated(RepairRequest.Application.Requests.Comands.SetCompletedStatus.SetCompletedStatusComand, MediatR.IMediator, System.Threading.CancellationToken) on controller RepairRequest.Api.Controllers.RepairRequestController (RepairRequest.Api).
2024-06-18 12:15:25.936 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__currentUserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Login], [u].[PasswordHash], [u].[Phone]
FROM [Users] AS [u]
WHERE [u].[Id] = @__currentUserId_0
2024-06-18 12:15:25.938 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [r].[Id], [r].[LeadTime], [r].[MasterId], [r].[RequestStatusId], [r].[ServiceCenterId], [r].[StatusId], [r].[UserId]
FROM [Requests] AS [r]
WHERE [r].[Id] = @__request_Id_0
2024-06-18 12:15:26.159 +03:00 [INF] Executed action RepairRequest.Api.Controllers.RepairRequestController.SetCompleated (RepairRequest.Api) in 249.5494ms
2024-06-18 12:15:26.159 +03:00 [INF] Executed endpoint 'RepairRequest.Api.Controllers.RepairRequestController.SetCompleated (RepairRequest.Api)'
2024-06-18 12:15:26.162 +03:00 [ERR] An unhandled exception has occurred while executing the request.
RepairRequest.Service.Exeptions.ForbidenExeption: No permision
   at RepairRequest.Application.Requests.Comands.SetCompletedStatus.SetCompletedStatusComandHandler.Handle(SetCompletedStatusComand request, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequest.Application\Requests\Comands\SetCompletedStatus\SetCompletedStatusComandHandler.cs:line 62
   at RepairRequest.Application.Behaviors.ContextTransactionBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequest.Application\Behaviors\ContextTransactionBehavior.cs:line 20
   at RepairRequest.Application.Behaviors.ContextTransactionBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequest.Application\Behaviors\ContextTransactionBehavior.cs:line 27
   at RepairRequest.Application.Behaviors.ContextTransactionBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequest.Application\Behaviors\ContextTransactionBehavior.cs:line 29
   at RepairRequest.Application.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequest.Application\Behaviors\ValidationBehavior.cs:line 24
   at RepairRequest.Api.Controllers.RepairRequestController.SetCompleated(SetCompletedStatusComand command, IMediator mediator, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequestMicroservice\RepairRequest.Api\Controllers\RepairRequestController.cs:line 91
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2024-06-18 12:15:26.202 +03:00 [INF] Request finished HTTP/2 PUT https://localhost:7014/repair-requests/complet - 500 null text/plain; charset=utf-8 306.545ms
2024-06-18 12:17:05.814 +03:00 [INF] Request starting HTTP/2 PUT https://localhost:7014/repair-requests/complet - application/json 13
2024-06-18 12:17:05.828 +03:00 [INF] Executing endpoint 'RepairRequest.Api.Controllers.RepairRequestController.SetCompleated (RepairRequest.Api)'
2024-06-18 12:17:05.829 +03:00 [INF] Route matched with {action = "SetCompleated", controller = "RepairRequest"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SetCompleated(RepairRequest.Application.Requests.Comands.SetCompletedStatus.SetCompletedStatusComand, MediatR.IMediator, System.Threading.CancellationToken) on controller RepairRequest.Api.Controllers.RepairRequestController (RepairRequest.Api).
2024-06-18 12:17:05.892 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__currentUserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Login], [u].[PasswordHash], [u].[Phone]
FROM [Users] AS [u]
WHERE [u].[Id] = @__currentUserId_0
2024-06-18 12:17:05.894 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [r].[Id], [r].[LeadTime], [r].[MasterId], [r].[RequestStatusId], [r].[ServiceCenterId], [r].[StatusId], [r].[UserId]
FROM [Requests] AS [r]
WHERE [r].[Id] = @__request_Id_0
2024-06-18 12:17:05.900 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [r].[Id], [r].[StatusName]
FROM [RequestStatuses] AS [r]
WHERE [r].[StatusName] = N'Completed'
2024-06-18 12:17:05.905 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@p6='?' (DbType = Int32), @p0='?' (DbType = DateTime2), @p1='?' (DbType = Int32), @p2='?' (DbType = Int32), @p3='?' (DbType = Int32), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Requests] SET [LeadTime] = @p0, [MasterId] = @p1, [RequestStatusId] = @p2, [ServiceCenterId] = @p3, [StatusId] = @p4, [UserId] = @p5
OUTPUT 1
WHERE [Id] = @p6;
2024-06-18 12:17:05.905 +03:00 [ERR] An error occurred using a transaction.
2024-06-18 12:17:06.116 +03:00 [INF] Executed action RepairRequest.Api.Controllers.RepairRequestController.SetCompleated (RepairRequest.Api) in 286.9438ms
2024-06-18 12:17:06.117 +03:00 [INF] Executed endpoint 'RepairRequest.Api.Controllers.RepairRequestController.SetCompleated (RepairRequest.Api)'
2024-06-18 12:17:06.119 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Commit()
   at Microsoft.Data.SqlClient.SqlTransaction.Commit()
   at System.Data.Common.DbTransaction.CommitAsync(CancellationToken cancellationToken)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.CommitAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.CommitAsync(CancellationToken cancellationToken)
   at RepairRequest.Percistance.ContextTransaction.CommitAsync(CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequestMicroservice\RepairRequest.Percistance\ContextTransaction.cs:line 16
   at RepairRequest.Application.Behaviors.ContextTransactionBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequest.Application\Behaviors\ContextTransactionBehavior.cs:line 21
   at RepairRequest.Application.Behaviors.ContextTransactionBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequest.Application\Behaviors\ContextTransactionBehavior.cs:line 27
   at RepairRequest.Application.Behaviors.ContextTransactionBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequest.Application\Behaviors\ContextTransactionBehavior.cs:line 29
   at RepairRequest.Application.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequest.Application\Behaviors\ValidationBehavior.cs:line 24
   at RepairRequest.Api.Controllers.RepairRequestController.SetCompleated(SetCompletedStatusComand command, IMediator mediator, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequestMicroservice\RepairRequest.Api\Controllers\RepairRequestController.cs:line 91
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2024-06-18 12:17:06.128 +03:00 [INF] Request finished HTTP/2 PUT https://localhost:7014/repair-requests/complet - 500 null text/plain; charset=utf-8 313.0135ms
2024-06-18 12:17:24.971 +03:00 [INF] User profile is available. Using 'C:\Users\vitia\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-06-18 12:17:25.246 +03:00 [INF] Now listening on: https://localhost:7014
2024-06-18 12:17:25.246 +03:00 [INF] Now listening on: http://localhost:5281
2024-06-18 12:17:25.248 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2024-06-18 12:17:25.248 +03:00 [INF] Hosting environment: Development
2024-06-18 12:17:25.248 +03:00 [INF] Content root path: D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequestMicroservice\RepairRequest.Api
2024-06-18 12:17:25.685 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/swagger/index.html - null null
2024-06-18 12:17:25.867 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/swagger/index.html - 200 null text/html;charset=utf-8 185.193ms
2024-06-18 12:17:25.874 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/_framework/aspnetcore-browser-refresh.js - null null
2024-06-18 12:17:25.880 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/_framework/aspnetcore-browser-refresh.js - 200 13770 application/javascript; charset=utf-8 5.8552ms
2024-06-18 12:17:25.887 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/_vs/browserLink - null null
2024-06-18 12:17:25.921 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/_vs/browserLink - 200 null text/javascript; charset=UTF-8 33.6952ms
2024-06-18 12:17:26.012 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/swagger/v1/swagger.json - null null
2024-06-18 12:17:26.118 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 106.1839ms
2024-06-18 12:17:52.373 +03:00 [INF] Request starting HTTP/2 PUT https://localhost:7014/repair-requests/complet - application/json 13
2024-06-18 12:17:52.492 +03:00 [INF] Executing endpoint 'RepairRequest.Api.Controllers.RepairRequestController.SetCompleated (RepairRequest.Api)'
2024-06-18 12:17:52.511 +03:00 [INF] Route matched with {action = "SetCompleated", controller = "RepairRequest"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SetCompleated(RepairRequest.Application.Requests.Comands.SetCompletedStatus.SetCompletedStatusComand, MediatR.IMediator, System.Threading.CancellationToken) on controller RepairRequest.Api.Controllers.RepairRequestController (RepairRequest.Api).
2024-06-18 12:17:53.823 +03:00 [INF] Executed DbCommand (38ms) [Parameters=[@__currentUserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Login], [u].[PasswordHash], [u].[Phone]
FROM [Users] AS [u]
WHERE [u].[Id] = @__currentUserId_0
2024-06-18 12:17:53.896 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__request_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [r].[Id], [r].[LeadTime], [r].[MasterId], [r].[RequestStatusId], [r].[ServiceCenterId], [r].[StatusId], [r].[UserId]
FROM [Requests] AS [r]
WHERE [r].[Id] = @__request_Id_0
2024-06-18 12:17:53.924 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [r].[Id], [r].[StatusName]
FROM [RequestStatuses] AS [r]
WHERE [r].[StatusName] = N'Completed'
2024-06-18 12:17:54.034 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@p6='?' (DbType = Int32), @p0='?' (DbType = DateTime2), @p1='?' (DbType = Int32), @p2='?' (DbType = Int32), @p3='?' (DbType = Int32), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Requests] SET [LeadTime] = @p0, [MasterId] = @p1, [RequestStatusId] = @p2, [ServiceCenterId] = @p3, [StatusId] = @p4, [UserId] = @p5
OUTPUT 1
WHERE [Id] = @p6;
2024-06-18 12:17:54.041 +03:00 [ERR] An error occurred using a transaction.
2024-06-18 12:17:54.292 +03:00 [INF] Executed action RepairRequest.Api.Controllers.RepairRequestController.SetCompleated (RepairRequest.Api) in 1777.8873ms
2024-06-18 12:17:54.292 +03:00 [INF] Executed endpoint 'RepairRequest.Api.Controllers.RepairRequestController.SetCompleated (RepairRequest.Api)'
2024-06-18 12:17:54.295 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: There is already an open DataReader associated with this Connection which must be closed first.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Commit()
   at Microsoft.Data.SqlClient.SqlTransaction.Commit()
   at System.Data.Common.DbTransaction.CommitAsync(CancellationToken cancellationToken)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.CommitAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.CommitAsync(CancellationToken cancellationToken)
   at RepairRequest.Percistance.ContextTransaction.CommitAsync(CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequestMicroservice\RepairRequest.Percistance\ContextTransaction.cs:line 16
   at RepairRequest.Application.Behaviors.ContextTransactionBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequest.Application\Behaviors\ContextTransactionBehavior.cs:line 21
   at RepairRequest.Application.Behaviors.ContextTransactionBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequest.Application\Behaviors\ContextTransactionBehavior.cs:line 27
   at RepairRequest.Application.Behaviors.ContextTransactionBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequest.Application\Behaviors\ContextTransactionBehavior.cs:line 29
   at RepairRequest.Application.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequest.Application\Behaviors\ValidationBehavior.cs:line 24
   at RepairRequest.Api.Controllers.RepairRequestController.SetCompleated(SetCompletedStatusComand command, IMediator mediator, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequestMicroservice\RepairRequest.Api\Controllers\RepairRequestController.cs:line 91
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2024-06-18 12:17:54.338 +03:00 [INF] Request finished HTTP/2 PUT https://localhost:7014/repair-requests/complet - 500 null text/plain; charset=utf-8 1964.4849ms
2024-06-18 12:18:12.549 +03:00 [INF] Request starting HTTP/2 PUT https://localhost:7014/repair-requests/complet - application/json 13
2024-06-18 12:18:12.554 +03:00 [INF] Executing endpoint 'RepairRequest.Api.Controllers.RepairRequestController.SetCompleated (RepairRequest.Api)'
2024-06-18 12:18:12.554 +03:00 [INF] Route matched with {action = "SetCompleated", controller = "RepairRequest"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SetCompleated(RepairRequest.Application.Requests.Comands.SetCompletedStatus.SetCompletedStatusComand, MediatR.IMediator, System.Threading.CancellationToken) on controller RepairRequest.Api.Controllers.RepairRequestController (RepairRequest.Api).
2024-06-18 12:18:12.578 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__currentUserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Login], [u].[PasswordHash], [u].[Phone]
FROM [Users] AS [u]
WHERE [u].[Id] = @__currentUserId_0
2024-06-18 12:18:12.580 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [r].[Id], [r].[LeadTime], [r].[MasterId], [r].[RequestStatusId], [r].[ServiceCenterId], [r].[StatusId], [r].[UserId]
FROM [Requests] AS [r]
WHERE [r].[Id] = @__request_Id_0
2024-06-18 12:18:12.581 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [r].[Id], [r].[StatusName]
FROM [RequestStatuses] AS [r]
WHERE [r].[StatusName] = N'Completed'
2024-06-18 12:18:12.585 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p6='?' (DbType = Int32), @p0='?' (DbType = DateTime2), @p1='?' (DbType = Int32), @p2='?' (DbType = Int32), @p3='?' (DbType = Int32), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Requests] SET [LeadTime] = @p0, [MasterId] = @p1, [RequestStatusId] = @p2, [ServiceCenterId] = @p3, [StatusId] = @p4, [UserId] = @p5
OUTPUT 1
WHERE [Id] = @p6;
2024-06-18 12:18:12.586 +03:00 [ERR] An error occurred using a transaction.
2024-06-18 12:18:12.782 +03:00 [INF] Executed action RepairRequest.Api.Controllers.RepairRequestController.SetCompleated (RepairRequest.Api) in 228.041ms
2024-06-18 12:18:12.783 +03:00 [INF] Executed endpoint 'RepairRequest.Api.Controllers.RepairRequestController.SetCompleated (RepairRequest.Api)'
2024-06-18 12:18:12.784 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: There is already an open DataReader associated with this Connection which must be closed first.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Commit()
   at Microsoft.Data.SqlClient.SqlTransaction.Commit()
   at System.Data.Common.DbTransaction.CommitAsync(CancellationToken cancellationToken)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.CommitAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.CommitAsync(CancellationToken cancellationToken)
   at RepairRequest.Percistance.ContextTransaction.CommitAsync(CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequestMicroservice\RepairRequest.Percistance\ContextTransaction.cs:line 16
   at RepairRequest.Application.Behaviors.ContextTransactionBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequest.Application\Behaviors\ContextTransactionBehavior.cs:line 21
   at RepairRequest.Application.Behaviors.ContextTransactionBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequest.Application\Behaviors\ContextTransactionBehavior.cs:line 27
   at RepairRequest.Application.Behaviors.ContextTransactionBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequest.Application\Behaviors\ContextTransactionBehavior.cs:line 29
   at RepairRequest.Application.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequest.Application\Behaviors\ValidationBehavior.cs:line 24
   at RepairRequest.Api.Controllers.RepairRequestController.SetCompleated(SetCompletedStatusComand command, IMediator mediator, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequestMicroservice\RepairRequest.Api\Controllers\RepairRequestController.cs:line 91
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2024-06-18 12:18:12.789 +03:00 [INF] Request finished HTTP/2 PUT https://localhost:7014/repair-requests/complet - 500 null text/plain; charset=utf-8 240.5431ms
2024-06-18 12:18:24.446 +03:00 [INF] User profile is available. Using 'C:\Users\vitia\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-06-18 12:18:24.771 +03:00 [INF] Now listening on: https://localhost:7014
2024-06-18 12:18:24.771 +03:00 [INF] Now listening on: http://localhost:5281
2024-06-18 12:18:24.773 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2024-06-18 12:18:24.773 +03:00 [INF] Hosting environment: Development
2024-06-18 12:18:24.773 +03:00 [INF] Content root path: D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequestMicroservice\RepairRequest.Api
2024-06-18 12:18:26.288 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/swagger/index.html - null null
2024-06-18 12:18:26.573 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/swagger/index.html - 200 null text/html;charset=utf-8 295.7625ms
2024-06-18 12:18:26.590 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/_framework/aspnetcore-browser-refresh.js - null null
2024-06-18 12:18:26.595 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/_framework/aspnetcore-browser-refresh.js - 200 13770 application/javascript; charset=utf-8 5.3569ms
2024-06-18 12:18:26.599 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/_vs/browserLink - null null
2024-06-18 12:18:26.643 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/_vs/browserLink - 200 null text/javascript; charset=UTF-8 44.4431ms
2024-06-18 12:18:26.748 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/swagger/v1/swagger.json - null null
2024-06-18 12:18:26.871 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 123.1065ms
2024-06-18 12:18:38.968 +03:00 [INF] Request starting HTTP/2 PUT https://localhost:7014/repair-requests/complet - application/json 13
2024-06-18 12:18:39.087 +03:00 [INF] Executing endpoint 'RepairRequest.Api.Controllers.RepairRequestController.SetCompleated (RepairRequest.Api)'
2024-06-18 12:18:39.105 +03:00 [INF] Route matched with {action = "SetCompleated", controller = "RepairRequest"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SetCompleated(RepairRequest.Application.Requests.Comands.SetCompletedStatus.SetCompletedStatusComand, MediatR.IMediator, System.Threading.CancellationToken) on controller RepairRequest.Api.Controllers.RepairRequestController (RepairRequest.Api).
2024-06-18 12:18:40.380 +03:00 [INF] Executed DbCommand (40ms) [Parameters=[@__currentUserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Login], [u].[PasswordHash], [u].[Phone]
FROM [Users] AS [u]
WHERE [u].[Id] = @__currentUserId_0
2024-06-18 12:18:40.452 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__request_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [r].[Id], [r].[LeadTime], [r].[MasterId], [r].[RequestStatusId], [r].[ServiceCenterId], [r].[StatusId], [r].[UserId]
FROM [Requests] AS [r]
WHERE [r].[Id] = @__request_Id_0
2024-06-18 12:18:40.481 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [r].[Id], [r].[StatusName]
FROM [RequestStatuses] AS [r]
WHERE [r].[StatusName] = N'Completed'
2024-06-18 12:18:40.578 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@p6='?' (DbType = Int32), @p0='?' (DbType = DateTime2), @p1='?' (DbType = Int32), @p2='?' (DbType = Int32), @p3='?' (DbType = Int32), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Requests] SET [LeadTime] = @p0, [MasterId] = @p1, [RequestStatusId] = @p2, [ServiceCenterId] = @p3, [StatusId] = @p4, [UserId] = @p5
OUTPUT 1
WHERE [Id] = @p6;
2024-06-18 12:18:40.599 +03:00 [INF] Executing OkObjectResult, writing value of type 'RepairRequest.Application.dto.GetRequestsDTO'.
2024-06-18 12:18:40.612 +03:00 [INF] Executed action RepairRequest.Api.Controllers.RepairRequestController.SetCompleated (RepairRequest.Api) in 1503.7103ms
2024-06-18 12:18:40.612 +03:00 [INF] Executed endpoint 'RepairRequest.Api.Controllers.RepairRequestController.SetCompleated (RepairRequest.Api)'
2024-06-18 12:18:40.618 +03:00 [INF] Request finished HTTP/2 PUT https://localhost:7014/repair-requests/complet - 200 null application/json; charset=utf-8 1650.9727ms
2024-06-18 12:18:56.976 +03:00 [INF] Request starting HTTP/2 PUT https://localhost:7014/repair-requests/cancel-request - application/json 13
2024-06-18 12:18:56.980 +03:00 [INF] Executing endpoint 'RepairRequest.Api.Controllers.RepairRequestController.CancelRequest (RepairRequest.Api)'
2024-06-18 12:18:56.985 +03:00 [INF] Route matched with {action = "CancelRequest", controller = "RepairRequest"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CancelRequest(RepairRequest.Application.Requests.Comands.CancelRequest.CancelRequestComand, MediatR.IMediator, System.Threading.CancellationToken) on controller RepairRequest.Api.Controllers.RepairRequestController (RepairRequest.Api).
2024-06-18 12:18:57.009 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__currentUserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Login], [u].[PasswordHash], [u].[Phone]
FROM [Users] AS [u]
WHERE [u].[Id] = @__currentUserId_0
2024-06-18 12:18:57.011 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [r].[Id], [r].[LeadTime], [r].[MasterId], [r].[RequestStatusId], [r].[ServiceCenterId], [r].[StatusId], [r].[UserId]
FROM [Requests] AS [r]
WHERE [r].[Id] = @__request_Id_0
2024-06-18 12:18:57.017 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [r].[Id], [r].[StatusName]
FROM [RequestStatuses] AS [r]
WHERE [r].[StatusName] = N'Canceled by Client'
2024-06-18 12:18:57.020 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@p6='?' (DbType = Int32), @p0='?' (DbType = DateTime2), @p1='?' (DbType = Int32), @p2='?' (DbType = Int32), @p3='?' (DbType = Int32), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Requests] SET [LeadTime] = @p0, [MasterId] = @p1, [RequestStatusId] = @p2, [ServiceCenterId] = @p3, [StatusId] = @p4, [UserId] = @p5
OUTPUT 1
WHERE [Id] = @p6;
2024-06-18 12:18:57.021 +03:00 [INF] Executing OkObjectResult, writing value of type 'RepairRequest.Application.dto.GetRequestsDTO'.
2024-06-18 12:18:57.021 +03:00 [INF] Executed action RepairRequest.Api.Controllers.RepairRequestController.CancelRequest (RepairRequest.Api) in 36.836ms
2024-06-18 12:18:57.022 +03:00 [INF] Executed endpoint 'RepairRequest.Api.Controllers.RepairRequestController.CancelRequest (RepairRequest.Api)'
2024-06-18 12:18:57.022 +03:00 [INF] Request finished HTTP/2 PUT https://localhost:7014/repair-requests/cancel-request - 200 null application/json; charset=utf-8 46.0934ms
2024-06-18 12:19:49.626 +03:00 [INF] User profile is available. Using 'C:\Users\vitia\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-06-18 12:19:49.913 +03:00 [INF] Now listening on: https://localhost:7014
2024-06-18 12:19:49.913 +03:00 [INF] Now listening on: http://localhost:5281
2024-06-18 12:19:49.914 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2024-06-18 12:19:49.914 +03:00 [INF] Hosting environment: Development
2024-06-18 12:19:49.914 +03:00 [INF] Content root path: D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequestMicroservice\RepairRequest.Api
2024-06-18 12:19:50.582 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/swagger/index.html - null null
2024-06-18 12:19:50.783 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/swagger/index.html - 200 null text/html;charset=utf-8 208.339ms
2024-06-18 12:19:50.789 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/_framework/aspnetcore-browser-refresh.js - null null
2024-06-18 12:19:50.796 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/_framework/aspnetcore-browser-refresh.js - 200 13770 application/javascript; charset=utf-8 6.638ms
2024-06-18 12:19:50.804 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/_vs/browserLink - null null
2024-06-18 12:19:50.843 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/_vs/browserLink - 200 null text/javascript; charset=UTF-8 38.5877ms
2024-06-18 12:19:50.935 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/swagger/v1/swagger.json - null null
2024-06-18 12:19:51.054 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 119.259ms
2024-06-18 12:20:06.425 +03:00 [INF] Request starting HTTP/2 DELETE https://localhost:7014/repair-requests/4 - null null
2024-06-18 12:20:06.550 +03:00 [INF] Executing endpoint 'RepairRequest.Api.Controllers.RepairRequestController.Delete (RepairRequest.Api)'
2024-06-18 12:20:06.570 +03:00 [INF] Route matched with {action = "Delete", controller = "RepairRequest"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Delete(Int32, MediatR.IMediator) on controller RepairRequest.Api.Controllers.RepairRequestController (RepairRequest.Api).
2024-06-18 12:20:07.838 +03:00 [INF] Executed DbCommand (39ms) [Parameters=[@__request_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [r].[Id], [r].[LeadTime], [r].[MasterId], [r].[RequestStatusId], [r].[ServiceCenterId], [r].[StatusId], [r].[UserId]
FROM [Requests] AS [r]
WHERE [r].[Id] = @__request_Id_0
2024-06-18 12:20:07.910 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__request_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [r].[Id], [r].[LeadTime], [r].[MasterId], [r].[RequestStatusId], [r].[ServiceCenterId], [r].[StatusId], [r].[UserId]
FROM [Requests] AS [r]
WHERE [r].[Id] = @__request_Id_0
2024-06-18 12:20:08.155 +03:00 [INF] Executed action RepairRequest.Api.Controllers.RepairRequestController.Delete (RepairRequest.Api) in 1581.8664ms
2024-06-18 12:20:08.156 +03:00 [INF] Executed endpoint 'RepairRequest.Api.Controllers.RepairRequestController.Delete (RepairRequest.Api)'
2024-06-18 12:20:08.159 +03:00 [ERR] An unhandled exception has occurred while executing the request.
RepairRequest.Service.Exeptions.ForbidenExeption: Access denied
   at RepairRequest.Application.Comands.DeleteRequest.DeleteRequestComandHandler.Handle(DeleteRepairRequestComand request, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequest.Application\Requests\Comands\DeleteRequest\DeleteRequestComandHandler.cs:line 60
   at RepairRequest.Application.Behaviors.ContextTransactionBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequest.Application\Behaviors\ContextTransactionBehavior.cs:line 20
   at RepairRequest.Application.Behaviors.ContextTransactionBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequest.Application\Behaviors\ContextTransactionBehavior.cs:line 27
   at RepairRequest.Application.Behaviors.ContextTransactionBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequest.Application\Behaviors\ContextTransactionBehavior.cs:line 29
   at RepairRequest.Application.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequest.Application\Behaviors\ValidationBehavior.cs:line 24
   at RepairRequest.Api.Controllers.RepairRequestController.Delete(Int32 id, IMediator mediator) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequestMicroservice\RepairRequest.Api\Controllers\RepairRequestController.cs:line 64
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2024-06-18 12:20:08.191 +03:00 [INF] Request finished HTTP/2 DELETE https://localhost:7014/repair-requests/4 - 500 null text/plain; charset=utf-8 1766.5468ms
2024-06-18 12:20:40.464 +03:00 [INF] Request starting HTTP/2 DELETE https://localhost:7014/repair-requests/4 - null null
2024-06-18 12:20:40.470 +03:00 [INF] Executing endpoint 'RepairRequest.Api.Controllers.RepairRequestController.Delete (RepairRequest.Api)'
2024-06-18 12:20:40.471 +03:00 [INF] Route matched with {action = "Delete", controller = "RepairRequest"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Delete(Int32, MediatR.IMediator) on controller RepairRequest.Api.Controllers.RepairRequestController (RepairRequest.Api).
2024-06-18 12:20:40.492 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [r].[Id], [r].[LeadTime], [r].[MasterId], [r].[RequestStatusId], [r].[ServiceCenterId], [r].[StatusId], [r].[UserId]
FROM [Requests] AS [r]
WHERE [r].[Id] = @__request_Id_0
2024-06-18 12:20:40.494 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [r].[Id], [r].[LeadTime], [r].[MasterId], [r].[RequestStatusId], [r].[ServiceCenterId], [r].[StatusId], [r].[UserId]
FROM [Requests] AS [r]
WHERE [r].[Id] = @__request_Id_0
2024-06-18 12:20:40.502 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [r].[Id], [r].[StatusName]
FROM [RequestStatuses] AS [r]
WHERE [r].[StatusName] = N'Сanceled by master'
2024-06-18 12:20:40.593 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@p6='?' (DbType = Int32), @p0='?' (DbType = DateTime2), @p1='?' (DbType = Int32), @p2='?' (DbType = Int32), @p3='?' (DbType = Int32), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Requests] SET [LeadTime] = @p0, [MasterId] = @p1, [RequestStatusId] = @p2, [ServiceCenterId] = @p3, [StatusId] = @p4, [UserId] = @p5
OUTPUT 1
WHERE [Id] = @p6;
2024-06-18 16:00:28.169 +03:00 [INF] User profile is available. Using 'C:\Users\vitia\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-06-18 16:00:28.432 +03:00 [INF] Now listening on: https://localhost:7014
2024-06-18 16:00:28.432 +03:00 [INF] Now listening on: http://localhost:5281
2024-06-18 16:00:28.434 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2024-06-18 16:00:28.434 +03:00 [INF] Hosting environment: Development
2024-06-18 16:00:28.434 +03:00 [INF] Content root path: D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequestMicroservice\RepairRequest.Api
2024-06-18 16:00:29.151 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/swagger/index.html - null null
2024-06-18 16:00:29.675 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/swagger/index.html - 200 null text/html;charset=utf-8 534.2942ms
2024-06-18 16:00:29.689 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/_framework/aspnetcore-browser-refresh.js - null null
2024-06-18 16:00:29.695 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/_framework/aspnetcore-browser-refresh.js - 200 13770 application/javascript; charset=utf-8 6.0726ms
2024-06-18 16:00:29.699 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/_vs/browserLink - null null
2024-06-18 16:00:29.753 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/_vs/browserLink - 200 null text/javascript; charset=UTF-8 53.8081ms
2024-06-18 16:00:29.859 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/swagger/v1/swagger.json - null null
2024-06-18 16:00:29.974 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 115.8473ms
2024-06-18 16:00:34.025 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/repair-requests - null null
2024-06-18 16:00:35.031 +03:00 [INF] Executing endpoint 'RepairRequest.Api.Controllers.RepairRequestController.GetAll (RepairRequest.Api)'
2024-06-18 16:00:35.050 +03:00 [INF] Route matched with {action = "GetAll", controller = "RepairRequest"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll(RepairRequest.Application.Query.GetAll.GetListQuery, MediatR.IMediator, System.Threading.CancellationToken) on controller RepairRequest.Api.Controllers.RepairRequestController (RepairRequest.Api).
2024-06-18 16:00:39.111 +03:00 [INF] Executed DbCommand (28ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[LeadTime], [r].[MasterId], [r].[RequestStatusId], [r].[ServiceCenterId], [r].[StatusId], [r].[UserId]
FROM [Requests] AS [r]
ORDER BY [r].[Id]
2024-06-18 16:00:39.217 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[LeadTime], [r].[MasterId], [r].[RequestStatusId], [r].[ServiceCenterId], [r].[StatusId], [r].[UserId]
FROM [Requests] AS [r]
2024-06-18 16:00:39.226 +03:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[RepairRequest.Application.dto.GetRequestsDTO, RepairRequest.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2024-06-18 16:00:39.244 +03:00 [INF] Executed action RepairRequest.Api.Controllers.RepairRequestController.GetAll (RepairRequest.Api) in 4190.7796ms
2024-06-18 16:00:39.245 +03:00 [INF] Executed endpoint 'RepairRequest.Api.Controllers.RepairRequestController.GetAll (RepairRequest.Api)'
2024-06-18 16:00:39.251 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/repair-requests - 200 null application/json; charset=utf-8 5226.0048ms
2024-06-18 16:09:52.284 +03:00 [INF] User profile is available. Using 'C:\Users\vitia\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-06-18 16:09:52.535 +03:00 [INF] Now listening on: https://localhost:7014
2024-06-18 16:09:52.535 +03:00 [INF] Now listening on: http://localhost:5281
2024-06-18 16:09:52.536 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2024-06-18 16:09:52.536 +03:00 [INF] Hosting environment: Development
2024-06-18 16:09:52.536 +03:00 [INF] Content root path: D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequestMicroservice\RepairRequest.Api
2024-06-18 16:09:53.269 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/swagger/index.html - null null
2024-06-18 16:09:53.466 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/swagger/index.html - 200 null text/html;charset=utf-8 200.081ms
2024-06-18 16:09:53.477 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/_framework/aspnetcore-browser-refresh.js - null null
2024-06-18 16:09:53.483 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/_framework/aspnetcore-browser-refresh.js - 200 13770 application/javascript; charset=utf-8 6.6893ms
2024-06-18 16:09:53.490 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/_vs/browserLink - null null
2024-06-18 16:09:53.529 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/_vs/browserLink - 200 null text/javascript; charset=UTF-8 39.5219ms
2024-06-18 16:09:53.619 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/swagger/v1/swagger.json - null null
2024-06-18 16:09:53.730 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 111.969ms
2024-06-18 16:10:23.748 +03:00 [INF] Request starting HTTP/2 PUT https://localhost:7014/repair-requests/done - application/json 13
2024-06-18 16:10:24.198 +03:00 [INF] Executing endpoint 'RepairRequest.Api.Controllers.RepairRequestController.SetDone (RepairRequest.Api)'
2024-06-18 16:10:24.220 +03:00 [INF] Route matched with {action = "SetDone", controller = "RepairRequest"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SetDone(RepairRequest.Application.Requests.Comands.SetDoneStatus.SetDoneStatusComand, MediatR.IMediator, System.Threading.CancellationToken) on controller RepairRequest.Api.Controllers.RepairRequestController (RepairRequest.Api).
2024-06-18 16:10:25.590 +03:00 [INF] Executed DbCommand (154ms) [Parameters=[@__currentUserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Login], [u].[PasswordHash], [u].[Phone]
FROM [Users] AS [u]
WHERE [u].[Id] = @__currentUserId_0
2024-06-18 16:10:25.663 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__request_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [r].[Id], [r].[LeadTime], [r].[MasterId], [r].[RequestStatusId], [r].[ServiceCenterId], [r].[StatusId], [r].[UserId]
FROM [Requests] AS [r]
WHERE [r].[Id] = @__request_Id_0
2024-06-18 16:10:26.029 +03:00 [INF] Executed action RepairRequest.Api.Controllers.RepairRequestController.SetDone (RepairRequest.Api) in 1804.039ms
2024-06-18 16:10:26.030 +03:00 [INF] Executed endpoint 'RepairRequest.Api.Controllers.RepairRequestController.SetDone (RepairRequest.Api)'
2024-06-18 16:10:26.033 +03:00 [ERR] An unhandled exception has occurred while executing the request.
RepairRequest.Service.Exeptions.ForbidenExeption: No permision
   at RepairRequest.Application.Requests.Comands.SetDoneStatus.SetDoneStatusComandHandler.Handle(SetDoneStatusComand request, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequestMicroservice\RepairRequest.Application\Requests\Comands\SetDoneStatus\SetDoneStatusComandHandler.cs:line 60
   at RepairRequest.Application.Behaviors.ContextTransactionBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequestMicroservice\RepairRequest.Application\Behaviors\ContextTransactionBehavior.cs:line 20
   at RepairRequest.Application.Behaviors.ContextTransactionBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequestMicroservice\RepairRequest.Application\Behaviors\ContextTransactionBehavior.cs:line 27
   at RepairRequest.Application.Behaviors.ContextTransactionBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequestMicroservice\RepairRequest.Application\Behaviors\ContextTransactionBehavior.cs:line 29
   at RepairRequest.Application.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequestMicroservice\RepairRequest.Application\Behaviors\ValidationBehavior.cs:line 24
   at RepairRequest.Api.Controllers.RepairRequestController.SetDone(SetDoneStatusComand command, IMediator mediator, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequestMicroservice\RepairRequest.Api\Controllers\RepairRequestController.cs:line 78
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2024-06-18 16:10:26.085 +03:00 [INF] Request finished HTTP/2 PUT https://localhost:7014/repair-requests/done - 500 null text/plain; charset=utf-8 2337.4038ms
2024-06-18 16:10:58.183 +03:00 [INF] Request starting HTTP/2 PUT https://localhost:7014/repair-requests/done - application/json 13
2024-06-18 16:10:58.196 +03:00 [INF] Executing endpoint 'RepairRequest.Api.Controllers.RepairRequestController.SetDone (RepairRequest.Api)'
2024-06-18 16:10:58.197 +03:00 [INF] Route matched with {action = "SetDone", controller = "RepairRequest"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SetDone(RepairRequest.Application.Requests.Comands.SetDoneStatus.SetDoneStatusComand, MediatR.IMediator, System.Threading.CancellationToken) on controller RepairRequest.Api.Controllers.RepairRequestController (RepairRequest.Api).
2024-06-18 16:10:58.223 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__currentUserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Login], [u].[PasswordHash], [u].[Phone]
FROM [Users] AS [u]
WHERE [u].[Id] = @__currentUserId_0
2024-06-18 16:10:58.225 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [r].[Id], [r].[LeadTime], [r].[MasterId], [r].[RequestStatusId], [r].[ServiceCenterId], [r].[StatusId], [r].[UserId]
FROM [Requests] AS [r]
WHERE [r].[Id] = @__request_Id_0
2024-06-18 16:10:58.428 +03:00 [INF] Executed action RepairRequest.Api.Controllers.RepairRequestController.SetDone (RepairRequest.Api) in 230.5179ms
2024-06-18 16:10:58.428 +03:00 [INF] Executed endpoint 'RepairRequest.Api.Controllers.RepairRequestController.SetDone (RepairRequest.Api)'
2024-06-18 16:10:58.429 +03:00 [ERR] An unhandled exception has occurred while executing the request.
RepairRequest.Service.Exeptions.ForbidenExeption: No permision
   at RepairRequest.Application.Requests.Comands.SetDoneStatus.SetDoneStatusComandHandler.Handle(SetDoneStatusComand request, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequestMicroservice\RepairRequest.Application\Requests\Comands\SetDoneStatus\SetDoneStatusComandHandler.cs:line 60
   at RepairRequest.Application.Behaviors.ContextTransactionBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequestMicroservice\RepairRequest.Application\Behaviors\ContextTransactionBehavior.cs:line 20
   at RepairRequest.Application.Behaviors.ContextTransactionBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequestMicroservice\RepairRequest.Application\Behaviors\ContextTransactionBehavior.cs:line 27
   at RepairRequest.Application.Behaviors.ContextTransactionBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequestMicroservice\RepairRequest.Application\Behaviors\ContextTransactionBehavior.cs:line 29
   at RepairRequest.Application.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequestMicroservice\RepairRequest.Application\Behaviors\ValidationBehavior.cs:line 24
   at RepairRequest.Api.Controllers.RepairRequestController.SetDone(SetDoneStatusComand command, IMediator mediator, CancellationToken cancellationToken) in D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequestMicroservice\RepairRequest.Api\Controllers\RepairRequestController.cs:line 78
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2024-06-18 16:10:58.433 +03:00 [INF] Request finished HTTP/2 PUT https://localhost:7014/repair-requests/done - 500 null text/plain; charset=utf-8 250.6059ms
2024-06-18 16:11:25.418 +03:00 [INF] User profile is available. Using 'C:\Users\vitia\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-06-18 16:11:25.673 +03:00 [INF] Now listening on: https://localhost:7014
2024-06-18 16:11:25.673 +03:00 [INF] Now listening on: http://localhost:5281
2024-06-18 16:11:25.674 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2024-06-18 16:11:25.675 +03:00 [INF] Hosting environment: Development
2024-06-18 16:11:25.675 +03:00 [INF] Content root path: D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequestMicroservice\RepairRequest.Api
2024-06-18 16:11:26.507 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/swagger/index.html - null null
2024-06-18 16:11:26.721 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/swagger/index.html - 200 null text/html;charset=utf-8 218.073ms
2024-06-18 16:11:26.747 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/_framework/aspnetcore-browser-refresh.js - null null
2024-06-18 16:11:26.747 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/_vs/browserLink - null null
2024-06-18 16:11:26.756 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/_framework/aspnetcore-browser-refresh.js - 200 13770 application/javascript; charset=utf-8 10.046ms
2024-06-18 16:11:26.786 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/_vs/browserLink - 200 null text/javascript; charset=UTF-8 39.4388ms
2024-06-18 16:11:26.867 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/swagger/v1/swagger.json - null null
2024-06-18 16:11:26.978 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 112.2305ms
2024-06-18 16:11:47.566 +03:00 [INF] Request starting HTTP/2 PUT https://localhost:7014/repair-requests/done - application/json 13
2024-06-18 16:11:47.687 +03:00 [INF] Executing endpoint 'RepairRequest.Api.Controllers.RepairRequestController.SetDone (RepairRequest.Api)'
2024-06-18 16:11:47.709 +03:00 [INF] Route matched with {action = "SetDone", controller = "RepairRequest"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SetDone(RepairRequest.Application.Requests.Comands.SetDoneStatus.SetDoneStatusComand, MediatR.IMediator, System.Threading.CancellationToken) on controller RepairRequest.Api.Controllers.RepairRequestController (RepairRequest.Api).
2024-06-18 16:11:52.239 +03:00 [INF] Executed DbCommand (65ms) [Parameters=[@__currentUserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Login], [u].[PasswordHash], [u].[Phone]
FROM [Users] AS [u]
WHERE [u].[Id] = @__currentUserId_0
2024-06-18 16:11:54.218 +03:00 [INF] Executed DbCommand (25ms) [Parameters=[@__request_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [r].[Id], [r].[LeadTime], [r].[MasterId], [r].[RequestStatusId], [r].[ServiceCenterId], [r].[StatusId], [r].[UserId]
FROM [Requests] AS [r]
WHERE [r].[Id] = @__request_Id_0
2024-06-18 16:12:24.190 +03:00 [INF] User profile is available. Using 'C:\Users\vitia\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-06-18 16:12:24.497 +03:00 [INF] Now listening on: https://localhost:7014
2024-06-18 16:12:24.497 +03:00 [INF] Now listening on: http://localhost:5281
2024-06-18 16:12:24.499 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2024-06-18 16:12:24.500 +03:00 [INF] Hosting environment: Development
2024-06-18 16:12:24.500 +03:00 [INF] Content root path: D:\учёба\курсы ITA\Cycle Service\Cycle Service\RepairRequestMicroservice\RepairRequest.Api
2024-06-18 16:12:25.296 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/swagger/index.html - null null
2024-06-18 16:12:25.481 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/swagger/index.html - 200 null text/html;charset=utf-8 190.5306ms
2024-06-18 16:12:25.490 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/_framework/aspnetcore-browser-refresh.js - null null
2024-06-18 16:12:25.498 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/_framework/aspnetcore-browser-refresh.js - 200 13770 application/javascript; charset=utf-8 9.0674ms
2024-06-18 16:12:25.509 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/_vs/browserLink - null null
2024-06-18 16:12:25.552 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/_vs/browserLink - 200 null text/javascript; charset=UTF-8 43.1838ms
2024-06-18 16:12:25.636 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7014/swagger/v1/swagger.json - null null
2024-06-18 16:12:25.745 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7014/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 108.583ms
2024-06-18 16:13:05.992 +03:00 [INF] Request starting HTTP/2 PUT https://localhost:7014/repair-requests/accept-request - application/json 30
2024-06-18 16:13:06.111 +03:00 [INF] Executing endpoint 'RepairRequest.Api.Controllers.RepairRequestController.AcceptRequest (RepairRequest.Api)'
2024-06-18 16:13:06.130 +03:00 [INF] Route matched with {action = "AcceptRequest", controller = "RepairRequest"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AcceptRequest(RepairRequest.Application.Requests.Comands.AcceptRequest.AcceptRequestComand, MediatR.IMediator, System.Threading.CancellationToken) on controller RepairRequest.Api.Controllers.RepairRequestController (RepairRequest.Api).
2024-06-18 16:13:07.471 +03:00 [INF] Executed DbCommand (38ms) [Parameters=[@__request_MasterId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Login], [u].[PasswordHash], [u].[Phone]
FROM [Users] AS [u]
WHERE [u].[Id] = @__request_MasterId_0
2024-06-18 16:13:07.545 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[Name]
FROM [AppUserRole] AS [a]
WHERE [a].[Name] = N'Master'
2024-06-18 16:13:07.558 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__master_Id_0='?' (DbType = Int32), @__masterRole_Id_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[RoleId], [a].[UserId]
FROM [AppUserAppRole] AS [a]
WHERE [a].[UserId] = @__master_Id_0 AND [a].[RoleId] = @__masterRole_Id_1
2024-06-18 16:13:07.587 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [r].[Id], [r].[LeadTime], [r].[MasterId], [r].[RequestStatusId], [r].[ServiceCenterId], [r].[StatusId], [r].[UserId]
FROM [Requests] AS [r]
WHERE [r].[Id] = @__request_Id_0
2024-06-18 16:13:07.609 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [r].[Id], [r].[StatusName]
FROM [RequestStatuses] AS [r]
WHERE [r].[StatusName] = N'Accepted'
2024-06-18 16:13:07.714 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@p6='?' (DbType = Int32), @p0='?' (DbType = DateTime2), @p1='?' (DbType = Int32), @p2='?' (DbType = Int32), @p3='?' (DbType = Int32), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Requests] SET [LeadTime] = @p0, [MasterId] = @p1, [RequestStatusId] = @p2, [ServiceCenterId] = @p3, [StatusId] = @p4, [UserId] = @p5
OUTPUT 1
WHERE [Id] = @p6;
2024-06-18 16:13:07.748 +03:00 [INF] Executing OkObjectResult, writing value of type 'RepairRequest.Application.dto.GetRequestsDTO'.
2024-06-18 16:13:07.768 +03:00 [INF] Executed action RepairRequest.Api.Controllers.RepairRequestController.AcceptRequest (RepairRequest.Api) in 1634.7039ms
2024-06-18 16:13:07.769 +03:00 [INF] Executed endpoint 'RepairRequest.Api.Controllers.RepairRequestController.AcceptRequest (RepairRequest.Api)'
2024-06-18 16:13:07.775 +03:00 [INF] Request finished HTTP/2 PUT https://localhost:7014/repair-requests/accept-request - 200 null application/json; charset=utf-8 1783.6168ms
2024-06-18 16:13:18.061 +03:00 [INF] Request starting HTTP/2 PUT https://localhost:7014/repair-requests/done - application/json 13
2024-06-18 16:13:18.065 +03:00 [INF] Executing endpoint 'RepairRequest.Api.Controllers.RepairRequestController.SetDone (RepairRequest.Api)'
2024-06-18 16:13:18.071 +03:00 [INF] Route matched with {action = "SetDone", controller = "RepairRequest"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SetDone(RepairRequest.Application.Requests.Comands.SetDoneStatus.SetDoneStatusComand, MediatR.IMediator, System.Threading.CancellationToken) on controller RepairRequest.Api.Controllers.RepairRequestController (RepairRequest.Api).
2024-06-18 16:13:21.395 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__currentUserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Login], [u].[PasswordHash], [u].[Phone]
FROM [Users] AS [u]
WHERE [u].[Id] = @__currentUserId_0
2024-06-18 16:13:21.400 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [r].[Id], [r].[LeadTime], [r].[MasterId], [r].[RequestStatusId], [r].[ServiceCenterId], [r].[StatusId], [r].[UserId]
FROM [Requests] AS [r]
WHERE [r].[Id] = @__request_Id_0
2024-06-18 16:13:21.405 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [r].[Id], [r].[StatusName]
FROM [RequestStatuses] AS [r]
WHERE [r].[StatusName] = N'Done'
2024-06-18 16:13:21.409 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p6='?' (DbType = Int32), @p0='?' (DbType = DateTime2), @p1='?' (DbType = Int32), @p2='?' (DbType = Int32), @p3='?' (DbType = Int32), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Requests] SET [LeadTime] = @p0, [MasterId] = @p1, [RequestStatusId] = @p2, [ServiceCenterId] = @p3, [StatusId] = @p4, [UserId] = @p5
OUTPUT 1
WHERE [Id] = @p6;
2024-06-18 16:13:21.411 +03:00 [INF] Executing OkObjectResult, writing value of type 'RepairRequest.Application.dto.GetRequestsDTO'.
2024-06-18 16:13:21.411 +03:00 [INF] Executed action RepairRequest.Api.Controllers.RepairRequestController.SetDone (RepairRequest.Api) in 3339.8679ms
2024-06-18 16:13:21.411 +03:00 [INF] Executed endpoint 'RepairRequest.Api.Controllers.RepairRequestController.SetDone (RepairRequest.Api)'
2024-06-18 16:13:21.412 +03:00 [INF] Request finished HTTP/2 PUT https://localhost:7014/repair-requests/done - 200 null application/json; charset=utf-8 3350.5642ms
